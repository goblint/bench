/* Generated by CIL v. 1.8.2 */
/* print_CIL_Input is true */

typedef unsigned long size_t;
typedef signed char __int8_t;
typedef unsigned char __uint8_t;
typedef short __int16_t;
typedef unsigned short __uint16_t;
typedef int __int32_t;
typedef unsigned int __uint32_t;
typedef __int8_t int8_t;
typedef __int16_t int16_t;
typedef __int32_t int32_t;
struct __pthread_internal_list {
   struct __pthread_internal_list *__prev ;
   struct __pthread_internal_list *__next ;
};
typedef struct __pthread_internal_list __pthread_list_t;
struct __pthread_mutex_s {
   int __lock ;
   unsigned int __count ;
   int __owner ;
   unsigned int __nusers ;
   int __kind ;
   short __spins ;
   short __elision ;
   __pthread_list_t __list ;
};
struct __anonstruct___wseq32_112954846 {
   unsigned int __low ;
   unsigned int __high ;
};
union __anonunion____missing_field_name_937450124 {
   unsigned long long __wseq ;
   struct __anonstruct___wseq32_112954846 __wseq32 ;
};
struct __anonstruct___g1_start32_677907541 {
   unsigned int __low ;
   unsigned int __high ;
};
union __anonunion____missing_field_name_677907540 {
   unsigned long long __g1_start ;
   struct __anonstruct___g1_start32_677907541 __g1_start32 ;
};
struct __pthread_cond_s {
   union __anonunion____missing_field_name_937450124 __annonCompField1 ;
   union __anonunion____missing_field_name_677907540 __annonCompField2 ;
   unsigned int __g_refs[2] ;
   unsigned int __g_size[2] ;
   unsigned int __g1_orig_size ;
   unsigned int __wrefs ;
   unsigned int __g_signals[2] ;
};
typedef unsigned long pthread_t;
union pthread_attr_t {
   char __size[56] ;
   long __align ;
};
typedef union pthread_attr_t pthread_attr_t;
union __anonunion_pthread_mutex_t_335460617 {
   struct __pthread_mutex_s __data ;
   char __size[40] ;
   long __align ;
};
typedef union __anonunion_pthread_mutex_t_335460617 pthread_mutex_t;
union __anonunion_pthread_cond_t_951761805 {
   struct __pthread_cond_s __data ;
   char __size[48] ;
   long long __align ;
};
typedef union __anonunion_pthread_cond_t_951761805 pthread_cond_t;
typedef __uint8_t uint8_t;
typedef __uint16_t uint16_t;
typedef __uint32_t uint32_t;
enum __anonenum_freenect_device_flags_931223624 {
    FREENECT_DEVICE_MOTOR = 1,
    FREENECT_DEVICE_CAMERA = 2,
    FREENECT_DEVICE_AUDIO = 4
} ;
typedef enum __anonenum_freenect_device_flags_931223624 freenect_device_flags;
enum __anonenum_freenect_resolution_1036235832 {
    FREENECT_RESOLUTION_LOW = 0,
    FREENECT_RESOLUTION_MEDIUM = 1,
    FREENECT_RESOLUTION_HIGH = 2,
    FREENECT_RESOLUTION_DUMMY = 2147483647
} ;
typedef enum __anonenum_freenect_resolution_1036235832 freenect_resolution;
enum __anonenum_freenect_video_format_922200655 {
    FREENECT_VIDEO_RGB = 0,
    FREENECT_VIDEO_BAYER = 1,
    FREENECT_VIDEO_IR_8BIT = 2,
    FREENECT_VIDEO_IR_10BIT = 3,
    FREENECT_VIDEO_IR_10BIT_PACKED = 4,
    FREENECT_VIDEO_YUV_RGB = 5,
    FREENECT_VIDEO_YUV_RAW = 6,
    FREENECT_VIDEO_DUMMY = 2147483647
} ;
typedef enum __anonenum_freenect_video_format_922200655 freenect_video_format;
enum __anonenum_freenect_depth_format_454778101 {
    FREENECT_DEPTH_11BIT = 0,
    FREENECT_DEPTH_10BIT = 1,
    FREENECT_DEPTH_11BIT_PACKED = 2,
    FREENECT_DEPTH_10BIT_PACKED = 3,
    FREENECT_DEPTH_REGISTERED = 4,
    FREENECT_DEPTH_MM = 5,
    FREENECT_DEPTH_DUMMY = 2147483647
} ;
typedef enum __anonenum_freenect_depth_format_454778101 freenect_depth_format;
union __anonunion____missing_field_name_633756896 {
   int32_t dummy ;
   freenect_video_format video_format ;
   freenect_depth_format depth_format ;
};
struct __anonstruct_freenect_frame_mode_402645106 {
   uint32_t reserved ;
   freenect_resolution resolution ;
   union __anonunion____missing_field_name_633756896 __annonCompField3 ;
   int32_t bytes ;
   int16_t width ;
   int16_t height ;
   int8_t data_bits_per_pixel ;
   int8_t padding_bits_per_pixel ;
   int8_t framerate ;
   int8_t is_valid ;
};
typedef struct __anonstruct_freenect_frame_mode_402645106 freenect_frame_mode;
struct _freenect_context ;
typedef struct _freenect_context freenect_context;
struct _freenect_device ;
typedef struct _freenect_device freenect_device;
typedef void freenect_usb_context;
enum __anonenum_freenect_loglevel_817188290 {
    FREENECT_LOG_FATAL = 0,
    FREENECT_LOG_ERROR = 1,
    FREENECT_LOG_WARNING = 2,
    FREENECT_LOG_NOTICE = 3,
    FREENECT_LOG_INFO = 4,
    FREENECT_LOG_DEBUG = 5,
    FREENECT_LOG_SPEW = 6,
    FREENECT_LOG_FLOOD = 7
} ;
typedef enum __anonenum_freenect_loglevel_817188290 freenect_loglevel;
typedef unsigned int GLenum;
typedef unsigned char GLboolean;
typedef void GLvoid;
typedef int GLint;
typedef unsigned int GLuint;
typedef int GLsizei;
typedef float GLfloat;
typedef float GLclampf;
typedef double GLdouble;
typedef double GLclampd;
#pragma merger("0","/tmp/cil-KBnINcAi.i","-pthread")
extern int printf(char const   * __restrict  __format  , ...) ;
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1))) atoi)(char const   *__nptr )  __attribute__((__pure__)) ;
extern  __attribute__((__nothrow__)) void *malloc(size_t __size )  __attribute__((__malloc__)) ;
extern  __attribute__((__nothrow__)) void free(void *__ptr ) ;
extern  __attribute__((__nothrow__, __noreturn__)) void exit(int __status ) ;
extern  __attribute__((__nothrow__, __noreturn__)) void __assert_fail(char const   *__assertion ,
                                                                      char const   *__file ,
                                                                      unsigned int __line ,
                                                                      char const   *__function ) ;
extern int freenect_init(freenect_context **ctx , freenect_usb_context *usb_ctx ) ;
extern int freenect_shutdown(freenect_context *ctx ) ;
extern void freenect_set_log_level(freenect_context *ctx , freenect_loglevel level ) ;
extern int freenect_process_events(freenect_context *ctx ) ;
extern int freenect_num_devices(freenect_context *ctx ) ;
extern void freenect_select_subdevices(freenect_context *ctx , freenect_device_flags subdevs ) ;
extern int freenect_open_device(freenect_context *ctx , freenect_device **dev , int index ) ;
extern int freenect_close_device(freenect_device *dev ) ;
extern void freenect_set_depth_callback(freenect_device *dev , void (*cb)(freenect_device *dev ,
                                                                          void *depth ,
                                                                          uint32_t timestamp ) ) ;
extern void freenect_set_video_callback(freenect_device *dev , void (*cb)(freenect_device *dev ,
                                                                          void *video ,
                                                                          uint32_t timestamp ) ) ;
extern int freenect_set_video_buffer(freenect_device *dev , void *buf ) ;
extern int freenect_start_depth(freenect_device *dev ) ;
extern int freenect_start_video(freenect_device *dev ) ;
extern int freenect_stop_depth(freenect_device *dev ) ;
extern int freenect_stop_video(freenect_device *dev ) ;
extern freenect_frame_mode freenect_find_video_mode(freenect_resolution res , freenect_video_format fmt ) ;
extern int freenect_set_video_mode(freenect_device *dev , freenect_frame_mode mode ) ;
extern freenect_frame_mode freenect_find_depth_mode(freenect_resolution res , freenect_depth_format fmt ) ;
extern int freenect_set_depth_mode(freenect_device *dev , freenect_frame_mode const   mode ) ;
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,3))) pthread_create)(pthread_t * __restrict  __newthread ,
                                                                                             pthread_attr_t const   * __restrict  __attr ,
                                                                                             void *(*__start_routine)(void * ) ,
                                                                                             void * __restrict  __arg ) ;
extern int pthread_join(pthread_t __th , void **__thread_return ) ;
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1))) pthread_mutex_lock)(pthread_mutex_t *__mutex ) ;
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1))) pthread_mutex_unlock)(pthread_mutex_t *__mutex ) ;
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1))) pthread_cond_signal)(pthread_cond_t *__cond ) ;
extern int ( __attribute__((__nonnull__(1,2))) pthread_cond_wait)(pthread_cond_t * __restrict  __cond ,
                                                                  pthread_mutex_t * __restrict  __mutex ) ;
extern  __attribute__((__nothrow__)) float powf(float __x , float __y ) ;
extern void __attribute__((__visibility__("default")))  glClearColor(GLclampf red ,
                                                                     GLclampf green ,
                                                                     GLclampf blue ,
                                                                     GLclampf alpha ) ;
extern void __attribute__((__visibility__("default")))  glBlendFunc(GLenum sfactor ,
                                                                    GLenum dfactor ) ;
extern void __attribute__((__visibility__("default")))  glEnable(GLenum cap ) ;
extern void __attribute__((__visibility__("default")))  glDisable(GLenum cap ) ;
extern void __attribute__((__visibility__("default")))  glClearDepth(GLclampd depth ) ;
extern void __attribute__((__visibility__("default")))  glDepthFunc(GLenum func ) ;
extern void __attribute__((__visibility__("default")))  glDepthMask(GLboolean flag ) ;
extern void __attribute__((__visibility__("default")))  glMatrixMode(GLenum mode ) ;
extern void __attribute__((__visibility__("default")))  glOrtho(GLdouble left , GLdouble right ,
                                                                GLdouble bottom ,
                                                                GLdouble top , GLdouble near_val ,
                                                                GLdouble far_val ) ;
extern void __attribute__((__visibility__("default")))  glViewport(GLint x , GLint y ,
                                                                   GLsizei width ,
                                                                   GLsizei height ) ;
extern void __attribute__((__visibility__("default")))  glLoadIdentity(void) ;
extern void __attribute__((__visibility__("default")))  glBegin(GLenum mode ) ;
extern void __attribute__((__visibility__("default")))  glEnd(void) ;
extern void __attribute__((__visibility__("default")))  glVertex3f(GLfloat x , GLfloat y ,
                                                                   GLfloat z ) ;
extern void __attribute__((__visibility__("default")))  glColor4f(GLfloat red , GLfloat green ,
                                                                  GLfloat blue , GLfloat alpha ) ;
extern void __attribute__((__visibility__("default")))  glTexCoord2f(GLfloat s , GLfloat t ) ;
extern void __attribute__((__visibility__("default")))  glShadeModel(GLenum mode ) ;
extern void __attribute__((__visibility__("default")))  glTexParameteri(GLenum target ,
                                                                        GLenum pname ,
                                                                        GLint param ) ;
extern void __attribute__((__visibility__("default")))  glTexImage2D(GLenum target ,
                                                                     GLint level ,
                                                                     GLint internalFormat ,
                                                                     GLsizei width ,
                                                                     GLsizei height ,
                                                                     GLint border ,
                                                                     GLenum format ,
                                                                     GLenum type ,
                                                                     GLvoid const   *pixels ) ;
extern void __attribute__((__visibility__("default")))  glGenTextures(GLsizei n ,
                                                                      GLuint *textures ) ;
extern void __attribute__((__visibility__("default")))  glBindTexture(GLenum target ,
                                                                      GLuint texture ) ;
extern void glutInit(int *pargc , char **argv ) ;
extern void glutInitWindowPosition(int x , int y ) ;
extern void glutInitWindowSize(int width , int height ) ;
extern void glutInitDisplayMode(unsigned int displayMode ) ;
extern void glutMainLoop(void) ;
extern int glutCreateWindow(char const   *title ) ;
extern void glutDestroyWindow(int window ) ;
extern void glutPostRedisplay(void) ;
extern void glutSwapBuffers(void) ;
extern void glutIdleFunc(void (*callback)(void) ) ;
extern void glutKeyboardFunc(void (*callback)(unsigned char  , int  , int  ) ) ;
extern void glutReshapeFunc(void (*callback)(int  , int  ) ) ;
extern void glutDisplayFunc(void (*callback)(void) ) ;
extern int glutGet(GLenum query ) ;
pthread_t freenect_thread  ;
int volatile   die  =    (int volatile   )0;
int g_argc  ;
char **g_argv  ;
int window  ;
pthread_mutex_t gl_backbuf_mutex  =    {{0, 0U, 0, 0U, 0, (short)0, (short)0, {(struct __pthread_internal_list *)0, (struct __pthread_internal_list *)0}}};
uint8_t *depth_mid  ;
uint8_t *depth_front  ;
uint8_t *rgb_back  ;
uint8_t *rgb_mid  ;
uint8_t *rgb_front  ;
GLuint gl_depth_tex  ;
GLuint gl_rgb_tex  ;
freenect_context *f_ctx  ;
freenect_device *f_dev  ;
int freenect_angle  =    0;
int freenect_led  ;
pthread_cond_t gl_frame_cond  =    {{{0ULL}, {0ULL}, {0U, 0U}, {0U, 0U}, 0U, 0U, {0U, 0U}}};
int got_rgb  =    0;
int got_depth  =    0;
int frame  =    0;
int my_ftime  =    0;
double fps  =    (double )0;
void idle(void) 
{ 


  {
  pthread_mutex_lock(& gl_backbuf_mutex);
  while (1) {
    if (! got_depth) {
      if (! (! got_rgb)) {
        break;
      }
    } else {
      break;
    }
    pthread_cond_wait((pthread_cond_t * __restrict  )(& gl_frame_cond), (pthread_mutex_t * __restrict  )(& gl_backbuf_mutex));
  }
  if (! got_depth) {
    pthread_mutex_unlock(& gl_backbuf_mutex);
    return;
  } else
  if (! got_rgb) {
    pthread_mutex_unlock(& gl_backbuf_mutex);
    return;
  }
  pthread_mutex_unlock(& gl_backbuf_mutex);
  glutPostRedisplay();
  return;
}
}
void DrawGLScene(void) 
{ 
  uint8_t *tmp ;
  int ms ;
  int tmp___0 ;

  {
  pthread_mutex_lock(& gl_backbuf_mutex);
  if (got_depth) {
    tmp = depth_front;
    depth_front = depth_mid;
    depth_mid = tmp;
    got_depth = 0;
  }
  if (got_rgb) {
    tmp = rgb_front;
    rgb_front = rgb_mid;
    rgb_mid = tmp;
    got_rgb = 0;
  }
  pthread_mutex_unlock(& gl_backbuf_mutex);
  glBindTexture((GLenum )3553, gl_rgb_tex);
  glTexImage2D((GLenum )3553, 0, 3, 640, 480, 0, (GLenum )6407, (GLenum )5121, (GLvoid const   *)rgb_front);
  glBegin((GLenum )6);
  glColor4f(1.0f, 1.0f, 1.0f, 1.0f);
  glTexCoord2f((GLfloat )0, (GLfloat )0);
  glVertex3f((GLfloat )0, (GLfloat )0, (GLfloat )0);
  glTexCoord2f((GLfloat )1, (GLfloat )0);
  glVertex3f((GLfloat )640, (GLfloat )0, (GLfloat )0);
  glTexCoord2f((GLfloat )1, (GLfloat )1);
  glVertex3f((GLfloat )640, (GLfloat )480, (GLfloat )0);
  glTexCoord2f((GLfloat )0, (GLfloat )1);
  glVertex3f((GLfloat )0, (GLfloat )480, (GLfloat )0);
  glEnd();
  glBindTexture((GLenum )3553, gl_depth_tex);
  glTexImage2D((GLenum )3553, 0, 4, 640, 480, 0, (GLenum )6408, (GLenum )5121, (GLvoid const   *)depth_front);
  glBegin((GLenum )6);
  glColor4f(1.0f, 1.0f, 1.0f, 1.0f);
  glTexCoord2f((GLfloat )0, (GLfloat )0);
  glVertex3f((GLfloat )0, (GLfloat )0, (GLfloat )0);
  glTexCoord2f((GLfloat )1, (GLfloat )0);
  glVertex3f((GLfloat )640, (GLfloat )0, (GLfloat )0);
  glTexCoord2f((GLfloat )1, (GLfloat )1);
  glVertex3f((GLfloat )640, (GLfloat )480, (GLfloat )0);
  glTexCoord2f((GLfloat )0, (GLfloat )1);
  glVertex3f((GLfloat )0, (GLfloat )480, (GLfloat )0);
  glEnd();
  glutSwapBuffers();
  frame ++;
  if (frame % 30 == 0) {
    tmp___0 = glutGet((GLenum )700);
    ms = tmp___0;
    fps = 30.0 / ((double )(ms - my_ftime) / 1000.0);
    my_ftime = ms;
  }
  return;
}
}
void keyPressed(unsigned char key , int x , int y ) 
{ 


  {
  if ((int )key == 27) {
    goto _L;
  } else
  if ((int )key == 113) {
    _L: /* CIL Label */ 
    die = (int volatile   )1;
    pthread_join(freenect_thread, (void **)((void *)0));
    pthread_cond_signal(& gl_frame_cond);
    glutDestroyWindow(window);
    free((void *)depth_mid);
    free((void *)depth_front);
    free((void *)rgb_back);
    free((void *)rgb_mid);
    free((void *)rgb_front);
    exit(0);
  }
  return;
}
}
void ReSizeGLScene(int Width , int Height ) 
{ 


  {
  glViewport(0, 0, Width, Height);
  glMatrixMode((GLenum )5889);
  glLoadIdentity();
  glOrtho((GLdouble )0, (GLdouble )640, (GLdouble )480, (GLdouble )0, (GLdouble )(- 1.0f),
          (GLdouble )1.0f);
  glMatrixMode((GLenum )5888);
  glLoadIdentity();
  return;
}
}
void InitGL(int Width , int Height ) 
{ 


  {
  glClearColor(0.0f, 0.0f, 0.0f, 0.0f);
  glClearDepth(1.0);
  glDepthFunc((GLenum )513);
  glDepthMask((GLboolean )0);
  glDisable((GLenum )2929);
  glEnable((GLenum )3042);
  glDisable((GLenum )3008);
  glEnable((GLenum )3553);
  glBlendFunc((GLenum )770, (GLenum )771);
  glShadeModel((GLenum )7424);
  glGenTextures(1, & gl_depth_tex);
  glBindTexture((GLenum )3553, gl_depth_tex);
  glTexParameteri((GLenum )3553, (GLenum )10241, 9729);
  glTexParameteri((GLenum )3553, (GLenum )10240, 9729);
  glGenTextures(1, & gl_rgb_tex);
  glBindTexture((GLenum )3553, gl_rgb_tex);
  glTexParameteri((GLenum )3553, (GLenum )10241, 9729);
  glTexParameteri((GLenum )3553, (GLenum )10240, 9729);
  ReSizeGLScene(Width, Height);
  return;
}
}
void *gl_threadfunc(void *arg ) 
{ 


  {
  printf((char const   * __restrict  )"GL thread\n");
  glutInit(& g_argc, g_argv);
  glutInitDisplayMode(26U);
  glutInitWindowSize(640, 480);
  glutInitWindowPosition(0, 0);
  window = glutCreateWindow("libfreenect Registration viewer");
  glutDisplayFunc(& DrawGLScene);
  glutIdleFunc(& idle);
  glutReshapeFunc(& ReSizeGLScene);
  glutKeyboardFunc(& keyPressed);
  InitGL(640, 480);
  glutMainLoop();
  return ((void *)0);
}
}
uint16_t t_gamma[10000]  ;
void depth_cb(freenect_device *dev , void *v_depth , uint32_t timestamp ) 
{ 
  int i ;
  uint16_t *depth ;
  int pval ;
  int lb ;

  {
  depth = (uint16_t *)v_depth;
  pthread_mutex_lock(& gl_backbuf_mutex);
  i = 0;
  while (i < 307200) {
    pval = (int )t_gamma[*(depth + i)] / 4;
    lb = pval & 255;
    *(depth_mid + (4 * i + 3)) = (uint8_t )128;
    if ((int )*(depth + i) == 0) {
      *(depth_mid + (4 * i + 3)) = (uint8_t )0;
    }
    switch (pval >> 8) {
    case 0: 
    *(depth_mid + 4 * i) = (uint8_t )255;
    *(depth_mid + (4 * i + 1)) = (uint8_t )(255 - lb);
    *(depth_mid + (4 * i + 2)) = (uint8_t )(255 - lb);
    break;
    case 1: 
    *(depth_mid + 4 * i) = (uint8_t )255;
    *(depth_mid + (4 * i + 1)) = (uint8_t )lb;
    *(depth_mid + (4 * i + 2)) = (uint8_t )0;
    break;
    case 2: 
    *(depth_mid + 4 * i) = (uint8_t )(255 - lb);
    *(depth_mid + (4 * i + 1)) = (uint8_t )255;
    *(depth_mid + (4 * i + 2)) = (uint8_t )0;
    break;
    case 3: 
    *(depth_mid + 4 * i) = (uint8_t )0;
    *(depth_mid + (4 * i + 1)) = (uint8_t )255;
    *(depth_mid + (4 * i + 2)) = (uint8_t )lb;
    break;
    case 4: 
    *(depth_mid + 4 * i) = (uint8_t )0;
    *(depth_mid + (4 * i + 1)) = (uint8_t )(255 - lb);
    *(depth_mid + (4 * i + 2)) = (uint8_t )255;
    break;
    case 5: 
    *(depth_mid + 4 * i) = (uint8_t )0;
    *(depth_mid + (4 * i + 1)) = (uint8_t )0;
    *(depth_mid + (4 * i + 2)) = (uint8_t )(255 - lb);
    break;
    default: 
    *(depth_mid + 4 * i) = (uint8_t )0;
    *(depth_mid + (4 * i + 1)) = (uint8_t )0;
    *(depth_mid + (4 * i + 2)) = (uint8_t )0;
    *(depth_mid + (4 * i + 3)) = (uint8_t )0;
    break;
    }
    i ++;
  }
  got_depth ++;
  pthread_cond_signal(& gl_frame_cond);
  pthread_mutex_unlock(& gl_backbuf_mutex);
  return;
}
}
void rgb_cb(freenect_device *dev , void *rgb , uint32_t timestamp ) 
{ 


  {
  pthread_mutex_lock(& gl_backbuf_mutex);
  if (! ((unsigned long )rgb_back == (unsigned long )rgb)) {
    __assert_fail("rgb_back == rgb", "regview.c", 286U, "rgb_cb");
  }
  rgb_back = rgb_mid;
  freenect_set_video_buffer(dev, (void *)rgb_back);
  rgb_mid = (uint8_t *)rgb;
  got_rgb ++;
  pthread_cond_signal(& gl_frame_cond);
  pthread_mutex_unlock(& gl_backbuf_mutex);
  return;
}
}
void *freenect_threadfunc(void *arg ) 
{ 
  freenect_frame_mode tmp ;
  freenect_frame_mode tmp___0 ;
  int res ;
  int tmp___1 ;

  {
  freenect_set_depth_callback(f_dev, & depth_cb);
  freenect_set_video_callback(f_dev, & rgb_cb);
  tmp = freenect_find_video_mode((freenect_resolution )1, (freenect_video_format )0);
  freenect_set_video_mode(f_dev, tmp);
  tmp___0 = freenect_find_depth_mode((freenect_resolution )1, (freenect_depth_format )4);
  freenect_set_depth_mode(f_dev, (freenect_frame_mode const   )tmp___0);
  freenect_set_video_buffer(f_dev, (void *)rgb_back);
  freenect_start_depth(f_dev);
  freenect_start_video(f_dev);
  printf((char const   * __restrict  )"\'w\'-tilt up, \'s\'-level, \'x\'-tilt down, \'0\'-\'6\'-select LED mode, \'f\'-video format\n");
  while (! die) {
    tmp___1 = freenect_process_events(f_ctx);
    res = tmp___1;
    if (res < 0) {
      if (res != -10) {
        printf((char const   * __restrict  )"\nError %d received from libusb - aborting.\n",
               res);
        break;
      }
    }
  }
  printf((char const   * __restrict  )"\nshutting down streams...\n");
  freenect_stop_depth(f_dev);
  freenect_stop_video(f_dev);
  freenect_close_device(f_dev);
  freenect_shutdown(f_ctx);
  printf((char const   * __restrict  )"-- done!\n");
  return ((void *)0);
}
}
int main(int argc , char **argv ) 
{ 
  int res ;
  void *tmp ;
  void *tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;
  void *tmp___3 ;
  int i ;
  float v ;
  float tmp___4 ;
  int tmp___5 ;
  int nr_devices ;
  int tmp___6 ;
  int user_device_number ;
  int tmp___7 ;

  {
  tmp = malloc((size_t )1228800);
  depth_mid = (uint8_t *)tmp;
  tmp___0 = malloc((size_t )1228800);
  depth_front = (uint8_t *)tmp___0;
  tmp___1 = malloc((size_t )921600);
  rgb_back = (uint8_t *)tmp___1;
  tmp___2 = malloc((size_t )921600);
  rgb_mid = (uint8_t *)tmp___2;
  tmp___3 = malloc((size_t )921600);
  rgb_front = (uint8_t *)tmp___3;
  printf((char const   * __restrict  )"Kinect camera test\n");
  i = 0;
  while (i < 10000) {
    v = (float )((double )i / 2048.0);
    tmp___4 = powf(v, (float )3);
    v = tmp___4 * (float )6;
    t_gamma[i] = (uint16_t )((v * (float )6) * (float )256);
    i ++;
  }
  g_argc = argc;
  g_argv = argv;
  tmp___5 = freenect_init(& f_ctx, (void *)0);
  if (tmp___5 < 0) {
    printf((char const   * __restrict  )"freenect_init() failed\n");
    return (1);
  }
  freenect_set_log_level(f_ctx, (freenect_loglevel )5);
  freenect_select_subdevices(f_ctx, (freenect_device_flags )2);
  tmp___6 = freenect_num_devices(f_ctx);
  nr_devices = tmp___6;
  printf((char const   * __restrict  )"Number of devices found: %d\n", nr_devices);
  user_device_number = 0;
  if (argc > 1) {
    user_device_number = atoi((char const   *)*(argv + 1));
  }
  if (nr_devices < 1) {
    freenect_shutdown(f_ctx);
    return (1);
  }
  tmp___7 = freenect_open_device(f_ctx, & f_dev, user_device_number);
  if (tmp___7 < 0) {
    printf((char const   * __restrict  )"Could not open device\n");
    freenect_shutdown(f_ctx);
    return (1);
  }
  res = pthread_create((pthread_t * __restrict  )(& freenect_thread), (pthread_attr_t const   * __restrict  )((void *)0),
                       & freenect_threadfunc, (void * __restrict  )((void *)0));
  if (res) {
    printf((char const   * __restrict  )"pthread_create failed\n");
    freenect_shutdown(f_ctx);
    return (1);
  }
  gl_threadfunc((void *)0);
  return (0);
}
}
#pragma merger("0","/tmp/cil-9l3SdmfW.i","-pthread")

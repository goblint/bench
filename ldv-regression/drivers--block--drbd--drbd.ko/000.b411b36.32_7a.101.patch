6798c6798
< #line 2457 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2458 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
8313,8317c8313,8315
<     __ns.i = mdev->state.i;
< #line 1830
<     __ns.ldv_37644.disk = 4U;
< #line 1830
<     _drbd_set_state(mdev, __ns, CS_HARD, 0);
---
>     if ((int )mdev->state.ldv_37644.disk > 4) {
> #line 1831
>       __ns.i = mdev->state.i;
8318a8317,8323
>       __ns.ldv_37644.disk = 4U;
> #line 1831
>       _drbd_set_state(mdev, __ns, CS_HARD, 0);
>     } else {
> 
>     }
> #line 1832
8325,8326d8329
< #line 1836
<   set_bit(19U, (unsigned long volatile   *)(& mdev->flags));
8328c8331
<   if ((int )mdev->state.ldv_37644.disk > 2) {
---
>   set_bit(19U, (unsigned long volatile   *)(& mdev->flags));
8329a8333,8334
>   if ((int )mdev->state.ldv_37644.disk > 2) {
> #line 1839
8331c8336
< #line 1838
---
> #line 1839
8333,8334d8337
< #line 1838
<     _drbd_set_state(mdev, __ns___0, CS_HARD, 0);
8335a8339,8340
>     _drbd_set_state(mdev, __ns___0, CS_HARD, 0);
> #line 1840
8341c8346
< #line 1842
---
> #line 1843
8345c8350
< #line 1845
---
> #line 1846
8349c8354
< #line 1855 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 1856 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
8357c8362
< #line 1858
---
> #line 1859
8359c8364
< #line 1860
---
> #line 1861
8361,8362d8365
< #line 1860
<     flags = _raw_spin_lock_irqsave(tmp);
8364c8367
<     __drbd_chk_io_error_(mdev, forcedetach, where);
---
>     flags = _raw_spin_lock_irqsave(tmp);
8365a8369,8370
>     __drbd_chk_io_error_(mdev, forcedetach, where);
> #line 1863
8370c8375
< #line 1864
---
> #line 1865
8374c8379
< #line 1890 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 1891 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
8380c8385
< #line 1892
---
> #line 1893
8384c8389
< #line 1895
---
> #line 1896
8388c8393
< #line 1898
---
> #line 1899
8393c8398
< #line 2153 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2154 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
8400c8405
< #line 2155
---
> #line 2156
8402c8407
< #line 2155
---
> #line 2156
8404c8409
< #line 2157
---
> #line 2158
8406c8411
< #line 2157
---
> #line 2158
8409c8414
<             2157);
---
>             2158);
8413,8414d8417
< #line 2158
<   if (i == 0) {
8415a8419,8420
>   if (i == 0) {
> #line 2160
8417c8422
< #line 2161
---
> #line 2162
8422c8427
< #line 2162
---
> #line 2163
8424c8429
< #line 2164
---
> #line 2165
8429c8434
< #line 2165
---
> #line 2166
8434c8439
< #line 2167
---
> #line 2168
8438c8443
< #line 2170 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2171 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
8444,8445d8448
< #line 2175
<   if ((unsigned int )*((unsigned char *)mdev + 2277UL) == 0U) {
8446a8450,8451
>   if ((unsigned int )*((unsigned char *)mdev + 2277UL) == 0U) {
> #line 2177
8451,8452d8455
< #line 2178
<   atomic_inc(& mdev->local_cnt);
8454c8457
<   io_allowed = (unsigned int )mdev->state.ldv_37644.disk >= (unsigned int )mins;
---
>   atomic_inc(& mdev->local_cnt);
8456c8459
<   if (io_allowed == 0) {
---
>   io_allowed = (unsigned int )mdev->state.ldv_37644.disk >= (unsigned int )mins;
8457a8461,8462
>   if (io_allowed == 0) {
> #line 2182
8462c8467
< #line 2182
---
> #line 2183
8466c8471
< #line 2444 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2445 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
8473c8478
< #line 2448
---
> #line 2449
8475,8476d8479
< #line 2448
<   if (tmp != 0) {
8477a8481,8482
>   if (tmp != 0) {
> #line 2450
8482,8483d8486
< #line 2451
<   r = blkdev_issue_flush((mdev->ldev)->md_bdev, 208U, 0);
8485c8488
<   if (r != 0) {
---
>   r = blkdev_issue_flush((mdev->ldev)->md_bdev, 208U, 0);
8487c8490
<     set_bit(14U, (unsigned long volatile   *)(& mdev->flags));
---
>   if (r != 0) {
8488a8492,8493
>     set_bit(14U, (unsigned long volatile   *)(& mdev->flags));
> #line 2455
8494c8499
< #line 2456
---
> #line 2457
12776c12781
< #line 2189 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2190 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
12788,12789d12792
< #line 2200
<   if ((unsigned int )*((unsigned short *)mdev + 1138UL) == 288U || (unsigned int )*((unsigned short *)mdev + 1138UL) == 304U) {
12790a12794,12795
>   if ((unsigned int )*((unsigned short *)mdev + 1138UL) == 288U || (unsigned int )*((unsigned short *)mdev + 1138UL) == 304U) {
> #line 2202
12793c12798
< #line 2203
---
> #line 2204
12795c12800
< #line 2203
---
> #line 2204
12798c12803
< #line 2206
---
> #line 2207
12800,12801d12804
< #line 2212
<     __asm__  volatile   ("": : : "memory");
12802a12806,12807
>     __asm__  volatile   ("": : : "memory");
> #line 2214
12804c12809
< #line 2213
---
> #line 2214
12807c12812
< #line 2216
---
> #line 2217
12810,12811d12814
< #line 2227
<     shift = (unsigned long long )mdev->rs_total > 4294967295ULL ? 16U : 10U;
12813c12816
<     left = *bits_left >> (int )shift;
---
>     shift = (unsigned long long )mdev->rs_total > 4294967295ULL ? 16U : 10U;
12815c12818
<     total = (mdev->rs_total >> (int )shift) + 1UL;
---
>     left = *bits_left >> (int )shift;
12817c12820
<     tmp___1 = 1000UL - (left * 1000UL) / total;
---
>     total = (mdev->rs_total >> (int )shift) + 1UL;
12818a12822,12823
>     tmp___1 = 1000UL - (left * 1000UL) / total;
> #line 2232
12821c12826
< #line 2233
---
> #line 2234
12825c12830
< #line 2319 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2320 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
12831c12836
< #line 2321
---
> #line 2322
14454,14458c14459,14461
<     __ns.i = mdev->state.i;
< #line 1830
<     __ns.ldv_37644.disk = 4U;
< #line 1830
<     _drbd_set_state(mdev, __ns, CS_HARD, 0);
---
>     if ((int )mdev->state.ldv_37644.disk > 4) {
> #line 1831
>       __ns.i = mdev->state.i;
14459a14463,14469
>       __ns.ldv_37644.disk = 4U;
> #line 1831
>       _drbd_set_state(mdev, __ns, CS_HARD, 0);
>     } else {
> 
>     }
> #line 1832
14466,14467d14475
< #line 1836
<   set_bit(19U, (unsigned long volatile   *)(& mdev->flags));
14469c14477
<   if ((int )mdev->state.ldv_37644.disk > 2) {
---
>   set_bit(19U, (unsigned long volatile   *)(& mdev->flags));
14470a14479,14480
>   if ((int )mdev->state.ldv_37644.disk > 2) {
> #line 1839
14472c14482
< #line 1838
---
> #line 1839
14474,14475d14483
< #line 1838
<     _drbd_set_state(mdev, __ns___0, CS_HARD, 0);
14476a14485,14486
>     _drbd_set_state(mdev, __ns___0, CS_HARD, 0);
> #line 1840
14482c14492
< #line 1842
---
> #line 1843
14486c14496
< #line 1845
---
> #line 1846
14490c14500
< #line 1903 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 1904 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
14497c14507
< #line 1906
---
> #line 1907
14499c14509
< #line 1906
---
> #line 1907
14501c14511
< #line 1906
---
> #line 1907
14504c14514
< #line 1906
---
> #line 1907
14507c14517
< #line 1906
---
> #line 1907
14511c14521
< #line 1985 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 1986 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
14518c14528
< #line 1988
---
> #line 1989
14520,14521d14529
< #line 1988
<   flags = _raw_spin_lock_irqsave(tmp);
14523c14531
<   list_add_tail(& w->list, & q->q);
---
>   flags = _raw_spin_lock_irqsave(tmp);
14524a14533,14534
>   list_add_tail(& w->list, & q->q);
> #line 1991
14526,14527d14535
< #line 1992
<   spin_unlock_irqrestore(& q->q_lock, flags);
14528a14537,14538
>   spin_unlock_irqrestore(& q->q_lock, flags);
> #line 1994
14532c14542
< #line 1995 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 1996 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
14538c14548
< #line 1997
---
> #line 1998
14540,14541d14549
< #line 1997
<   if (tmp != 0) {
14542a14551,14552
>   if (tmp != 0) {
> #line 1999
14547c14557
< #line 1999
---
> #line 2000
14551c14561
< #line 2001 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2002 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
14557,14558d14566
< #line 2003
<   set_bit(2U, (unsigned long volatile   *)(& mdev->flags));
14560c14568
<   wake_asender(mdev);
---
>   set_bit(2U, (unsigned long volatile   *)(& mdev->flags));
14561a14570,14571
>   wake_asender(mdev);
> #line 2006
14565c14575
< #line 2007 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2008 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
14572c14582
< #line 2011
---
> #line 2012
14574c14584
< #line 2011
---
> #line 2012
14578c14588
< #line 2026 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2027 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
14584,14585d14593
< #line 2028
<   _drbd_thread_stop(thi, 0, 1);
14586a14595,14596
>   _drbd_thread_stop(thi, 0, 1);
> #line 2030
14590c14600
< #line 2086 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2087 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
14596,14597d14605
< #line 2088
<   atomic_inc(& mdev->rs_pending_cnt);
14598a14607,14608
>   atomic_inc(& mdev->rs_pending_cnt);
> #line 2090
19382c19392
< #line 1874 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 1875 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
19388c19398
< #line 1876
---
> #line 1877
19392c19402
< #line 1879
---
> #line 1880
19396c19406
< #line 1882
---
> #line 1883
19401c19411
< #line 1917 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 1918 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
19419c19429
< #line 1920
---
> #line 1921
19423c19433
< #line 1924
---
> #line 1925
19425c19435
< #line 1924
---
> #line 1925
19427c19437
< #line 1924
---
> #line 1925
19429c19439
< #line 1924
---
> #line 1925
19431c19441
< #line 1924
---
> #line 1925
19433c19443
< #line 1924
---
> #line 1925
19436c19446
< #line 1924
---
> #line 1925
19439c19449
< #line 1927
---
> #line 1928
19442c19452
< #line 1929
---
> #line 1930
19444c19454
< #line 1929
---
> #line 1930
19446c19456
< #line 1929
---
> #line 1930
19448c19458
< #line 1929
---
> #line 1930
19450c19460
< #line 1932
---
> #line 1933
19452c19462
< #line 1932
---
> #line 1933
19454c19464
< #line 1932
---
> #line 1933
19456c19466
< #line 1935
---
> #line 1936
19459c19469
< #line 1937
---
> #line 1938
19461c19471
< #line 1937
---
> #line 1938
19463c19473
< #line 1937
---
> #line 1938
19465c19475
< #line 1937
---
> #line 1938
19469c19479
< #line 1940
---
> #line 1941
19473c19483
< #line 1974 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 1975 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
19480c19490
< #line 1977
---
> #line 1978
19482,19483d19491
< #line 1977
<   flags = _raw_spin_lock_irqsave(tmp);
19485c19493
<   list_add(& w->list, & q->q);
---
>   flags = _raw_spin_lock_irqsave(tmp);
19486a19495,19496
>   list_add(& w->list, & q->q);
> #line 1980
19488,19489d19497
< #line 1981
<   spin_unlock_irqrestore(& q->q_lock, flags);
19490a19499,19500
>   spin_unlock_irqrestore(& q->q_lock, flags);
> #line 1983
19494c19504
< #line 2014 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2015 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
19501c19511
< #line 2017
---
> #line 2018
19503c19513
< #line 2017
---
> #line 2018
19507c19517
< #line 2020 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2021 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
19514c19524
< #line 2023
---
> #line 2024
19516c19526
< #line 2023
---
> #line 2024
19520c19530
< #line 2105 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2106 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
19526,19527d19535
< #line 2107
<   atomic_inc(& mdev->unacked_cnt);
19528a19537,19538
>   atomic_inc(& mdev->unacked_cnt);
> #line 2109
19532c19542
< #line 2121 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2122 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
19538c19548
< #line 2123
---
> #line 2124
19540,19541d19549
< #line 2123
<   if (tmp != 0) {
19542a19551,19552
>   if (tmp != 0) {
> #line 2125
19547c19557
< #line 2125
---
> #line 2126
19551c19561
< #line 2133 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2134 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
19557,19558d19566
< #line 2137
<   atomic_inc(& mdev->net_cnt);
19560c19568
<   have_net_conf = (int )mdev->state.ldv_37644.conn > 1;
---
>   atomic_inc(& mdev->net_cnt);
19562c19570
<   if (have_net_conf == 0) {
---
>   have_net_conf = (int )mdev->state.ldv_37644.conn > 1;
19563a19572,19573
>   if (have_net_conf == 0) {
> #line 2141
19568c19578
< #line 2141
---
> #line 2142
19572c19582
< #line 2393 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2394 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
19578,19579d19587
< #line 2395
<   changed = mdev->ed_uuid != val;
19581c19589
<   mdev->ed_uuid = val;
---
>   changed = mdev->ed_uuid != val;
19582a19591,19592
>   mdev->ed_uuid = val;
> #line 2398
19586c19596
< #line 2400 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2401 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
19592c19602
< #line 2407
---
> #line 2408
19596c19606
< #line 2416 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2417 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
19603,19604d19612
< #line 2419
<   spin_lock(& mdev->peer_seq_lock);
19605a19614,19615
>   spin_lock(& mdev->peer_seq_lock);
> #line 2421
19607,19608d19616
< #line 2420
<   m = tmp > 0 ? mdev->peer_seq : new_seq;
19610c19618
<   mdev->peer_seq = m;
---
>   m = tmp > 0 ? mdev->peer_seq : new_seq;
19612c19620
<   spin_unlock(& mdev->peer_seq_lock);
---
>   mdev->peer_seq = m;
19614c19622
<   if (m == new_seq) {
---
>   spin_unlock(& mdev->peer_seq_lock);
19615a19624,19625
>   if (m == new_seq) {
> #line 2425
19620c19630
< #line 2425
---
> #line 2426
30671,30675c30681
<     __ns.i = mdev->state.i;
< #line 1830
<     __ns.ldv_37644.disk = 4U;
< #line 1830
<     _drbd_set_state(mdev, __ns, CS_HARD, 0);
---
>     if ((int )mdev->state.ldv_37644.disk > 4) {
30676a30683,30691
>       __ns.i = mdev->state.i;
> #line 1831
>       __ns.ldv_37644.disk = 4U;
> #line 1831
>       _drbd_set_state(mdev, __ns, CS_HARD, 0);
>     } else {
> 
>     }
> #line 1832
30683,30684d30697
< #line 1836
<   set_bit(19U, (unsigned long volatile   *)(& mdev->flags));
30686c30699
<   if ((int )mdev->state.ldv_37644.disk > 2) {
---
>   set_bit(19U, (unsigned long volatile   *)(& mdev->flags));
30687a30701,30702
>   if ((int )mdev->state.ldv_37644.disk > 2) {
> #line 1839
30689c30704
< #line 1838
---
> #line 1839
30691,30692d30705
< #line 1838
<     _drbd_set_state(mdev, __ns___0, CS_HARD, 0);
30693a30707,30708
>     _drbd_set_state(mdev, __ns___0, CS_HARD, 0);
> #line 1840
30699c30714
< #line 1842
---
> #line 1843
30703c30718
< #line 1845
---
> #line 1846
30707c30722
< #line 2063 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2064 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
30713,30714d30727
< #line 2065
<   atomic_inc(& mdev->ap_pending_cnt);
30715a30729,30730
>   atomic_inc(& mdev->ap_pending_cnt);
> #line 2067
30719c30734
< #line 2239 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2240 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
30726,30727d30740
< #line 2241
<   mxb = 1000000;
30728a30742,30743
>   mxb = 1000000;
> #line 2243
30730,30731d30744
< #line 2242
<   if (tmp != 0) {
30733c30746
<     mxb = (mdev->net_conf)->max_buffers;
---
>   if (tmp != 0) {
30734a30748,30749
>     mxb = (mdev->net_conf)->max_buffers;
> #line 2245
30739c30754
< #line 2246
---
> #line 2247
30743c30758
< #line 2249 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2250 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
30749c30764
< #line 2251
---
> #line 2252
30751c30766
< #line 2256
---
> #line 2257
30774c30789
< #line 2281
---
> #line 2282
30777,30778d30791
< #line 2285
<   if (mdev->agreed_pro_version <= 95) {
30779a30793,30794
>   if (mdev->agreed_pro_version <= 95) {
> #line 2287
30784c30799
< #line 2287
---
> #line 2288
30789c30804
< #line 2294
---
> #line 2295
30793c30808
< #line 2297
---
> #line 2298
30800c30815
< #line 2304
---
> #line 2305
30807c30822
< #line 2313
---
> #line 2314
30811c30826
< #line 2316
---
> #line 2317
30815c30830
< #line 2324 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2325 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
30827c30842
< #line 2326
---
> #line 2327
30829c30844
< #line 2326
---
> #line 2327
30831c30846
< #line 2328
---
> #line 2329
30833,30834d30847
< #line 2328
<   if (tmp___0 != 0) {
30835a30849,30850
>   if (tmp___0 != 0) {
> #line 2330
30840c30855
< #line 2330
---
> #line 2331
30842,30843d30856
< #line 2330
<   if (tmp___1 != 0) {
30844a30858,30859
>   if (tmp___1 != 0) {
> #line 2332
30849c30864
< #line 2338
---
> #line 2339
30851,30852d30865
< #line 2338
<   if (tmp___2 == 0) {
30853a30867,30868
>   if (tmp___2 == 0) {
> #line 2340
30858c30873
< #line 2343
---
> #line 2344
30860,30861d30874
< #line 2343
<   if (tmp___3 > mxb) {
30862a30876,30877
>   if (tmp___3 > mxb) {
> #line 2345
30867c30882
< #line 2345
---
> #line 2346
30869,30870d30883
< #line 2345
<   if (tmp___4 != 0) {
30871a30885,30886
>   if (tmp___4 != 0) {
> #line 2347
30876c30891
< #line 2347
---
> #line 2348
30880c30895
< #line 2350 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2351 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
30886c30901
< #line 2352
---
> #line 2353
30888,30889d30902
< #line 2354
<   spin_lock_irq(& mdev->req_lock);
30891c30904
<   rv = may_inc_ap_bio(mdev);
---
>   spin_lock_irq(& mdev->req_lock);
30893c30906
<   if ((int )rv) {
---
>   rv = may_inc_ap_bio(mdev);
30894a30908,30909
>   if ((int )rv) {
> #line 2358
30899c30914
< #line 2358
---
> #line 2359
30901c30916
< #line 2360
---
> #line 2361
30905c30920
< #line 2363 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2364 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
30914c30929
< #line 2373
---
> #line 2374
30916c30931
< #line 2373
---
> #line 2374
30918c30933
< #line 2373
---
> #line 2374
30923c30938
< #line 2373
---
> #line 2374
30925c30940
< #line 2373
---
> #line 2374
30927c30942
< #line 2373
---
> #line 2374
30929c30944
< #line 2373
---
> #line 2374
30931c30946
< #line 2373
---
> #line 2374
30933c30948
< #line 2373
---
> #line 2374
30936c30951
< #line 2373
---
> #line 2374
30938c30953
< #line 2373
---
> #line 2374
30940c30955
< #line 2373
---
> #line 2374
30942c30957
< #line 2373
---
> #line 2374
30947c30962
< #line 2373
---
> #line 2374
30949c30964
< #line 2373
---
> #line 2374
30952c30967
< #line 2373
---
> #line 2374
30955c30970
< #line 2376
---
> #line 2377
30959c30974
< #line 2376 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2377 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
30970c30985
< #line 2378
---
> #line 2379
30972,30973d30986
< #line 2378
<   mxb = tmp;
30974a30988,30989
>   mxb = tmp;
> #line 2380
30976c30991
< #line 2379
---
> #line 2380
30978c30993
< #line 2381
---
> #line 2382
30980c30995
< #line 2381
---
> #line 2382
30983c30998
<             2381);
---
>             2382);
30987,30988d31001
< #line 2385
<   if (ap_bio < mxb) {
30989a31003,31004
>   if (ap_bio < mxb) {
> #line 2387
30994c31009
< #line 2387
---
> #line 2388
30996c31011
< #line 2387
---
> #line 2388
30998,30999d31012
< #line 2387
<     if (tmp___2 != 0) {
31000a31014,31015
>     if (tmp___2 != 0) {
> #line 2389
31002,31003d31016
< #line 2388
<       if (tmp___1 == 0) {
31004a31018,31019
>       if (tmp___1 == 0) {
> #line 2390
31015c31030
< #line 2390
---
> #line 2391
33077c33092
<   if (rw == 1 && local != 0) {
---
>   if ((req->rq_state & 2048UL) != 0UL) {
33725,33729c33740,33744
<     __ns.i = mdev->state.i;
< #line 1830
<     __ns.ldv_37644.disk = 4U;
< #line 1830
<     _drbd_set_state(mdev, __ns, CS_HARD, 0);
---
>     if ((int )mdev->state.ldv_37644.disk > 4) {
> #line 1831
>       __ns.i = mdev->state.i;
> #line 1831
>       __ns.ldv_37644.disk = 4U;
33730a33746,33750
>       _drbd_set_state(mdev, __ns, CS_HARD, 0);
>     } else {
> 
>     }
> #line 1832
33737,33738d33756
< #line 1836
<   set_bit(19U, (unsigned long volatile   *)(& mdev->flags));
33740c33758
<   if ((int )mdev->state.ldv_37644.disk > 2) {
---
>   set_bit(19U, (unsigned long volatile   *)(& mdev->flags));
33741a33760,33761
>   if ((int )mdev->state.ldv_37644.disk > 2) {
> #line 1839
33743c33763
< #line 1838
---
> #line 1839
33745,33746d33764
< #line 1838
<     _drbd_set_state(mdev, __ns___0, CS_HARD, 0);
33747a33766,33767
>     _drbd_set_state(mdev, __ns___0, CS_HARD, 0);
> #line 1840
33753c33773
< #line 1842
---
> #line 1843
33757c33777
< #line 1845
---
> #line 1846
33761c33781
< #line 1855 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 1856 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
33769c33789
< #line 1858
---
> #line 1859
33771c33791
< #line 1860
---
> #line 1861
33773,33774d33792
< #line 1860
<     flags = _raw_spin_lock_irqsave(tmp);
33776c33794
<     __drbd_chk_io_error____2(mdev, forcedetach, where);
---
>     flags = _raw_spin_lock_irqsave(tmp);
33777a33796,33797
>     __drbd_chk_io_error____2(mdev, forcedetach, where);
> #line 1863
33782c33802
< #line 1864
---
> #line 1865
37918,37922c37938,37942
<     __ns.i = mdev->state.i;
< #line 1830
<     __ns.ldv_37644.disk = 4U;
< #line 1830
<     _drbd_set_state(mdev, __ns, CS_HARD, 0);
---
>     if ((int )mdev->state.ldv_37644.disk > 4) {
> #line 1831
>       __ns.i = mdev->state.i;
> #line 1831
>       __ns.ldv_37644.disk = 4U;
37923a37944,37948
>       _drbd_set_state(mdev, __ns, CS_HARD, 0);
>     } else {
> 
>     }
> #line 1832
37930,37931d37954
< #line 1836
<   set_bit(19U, (unsigned long volatile   *)(& mdev->flags));
37933c37956
<   if ((int )mdev->state.ldv_37644.disk > 2) {
---
>   set_bit(19U, (unsigned long volatile   *)(& mdev->flags));
37934a37958,37959
>   if ((int )mdev->state.ldv_37644.disk > 2) {
> #line 1839
37936c37961
< #line 1838
---
> #line 1839
37938,37939d37962
< #line 1838
<     _drbd_set_state(mdev, __ns___0, CS_HARD, 0);
37940a37964,37965
>     _drbd_set_state(mdev, __ns___0, CS_HARD, 0);
> #line 1840
37946c37971
< #line 1842
---
> #line 1843
37950c37975
< #line 1845
---
> #line 1846
37954c37979
< #line 1855 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 1856 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
37962c37987
< #line 1858
---
> #line 1859
37964c37989
< #line 1860
---
> #line 1861
37966,37967d37990
< #line 1860
<     flags = _raw_spin_lock_irqsave(tmp);
37969c37992
<     __drbd_chk_io_error____3(mdev, forcedetach, where);
---
>     flags = _raw_spin_lock_irqsave(tmp);
37970a37994,37995
>     __drbd_chk_io_error____3(mdev, forcedetach, where);
> #line 1863
37975c38000
< #line 1864
---
> #line 1865
37979c38004
< #line 1917 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 1918 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
37997c38022
< #line 1920
---
> #line 1921
38001c38026
< #line 1924
---
> #line 1925
38003c38028
< #line 1924
---
> #line 1925
38005c38030
< #line 1924
---
> #line 1925
38007c38032
< #line 1924
---
> #line 1925
38009c38034
< #line 1924
---
> #line 1925
38011c38036
< #line 1924
---
> #line 1925
38014c38039
< #line 1924
---
> #line 1925
38017c38042
< #line 1927
---
> #line 1928
38020c38045
< #line 1929
---
> #line 1930
38022c38047
< #line 1929
---
> #line 1930
38024c38049
< #line 1929
---
> #line 1930
38026c38051
< #line 1929
---
> #line 1930
38028c38053
< #line 1932
---
> #line 1933
38030c38055
< #line 1932
---
> #line 1933
38032c38057
< #line 1932
---
> #line 1933
38034c38059
< #line 1935
---
> #line 1936
38037c38062
< #line 1937
---
> #line 1938
38039c38064
< #line 1937
---
> #line 1938
38041c38066
< #line 1937
---
> #line 1938
38043c38068
< #line 1937
---
> #line 1938
38047c38072
< #line 1940
---
> #line 1941
38051c38076
< #line 1948 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 1949 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
38058c38083
< #line 1951
---
> #line 1952
38061c38086
< #line 1953
---
> #line 1954
38065,38066d38089
< #line 1959
<   if ((unsigned long )bdev->backing_bdev == (unsigned long )((struct block_device *)0)) {
38067a38091,38092
>   if ((unsigned long )bdev->backing_bdev == (unsigned long )((struct block_device *)0)) {
> #line 1961
38069,38070d38093
< #line 1960
<     if (tmp != 0) {
38072c38095
<       dev_err((struct device  const  *)(& (mdev->vdisk)->part0.__dev), "bdev->backing_bdev==NULL\n");
---
>     if (tmp != 0) {
38073a38097,38098
>       dev_err((struct device  const  *)(& (mdev->vdisk)->part0.__dev), "bdev->backing_bdev==NULL\n");
> #line 1963
38078c38103
< #line 1964
---
> #line 1965
38083c38108
< #line 1966
---
> #line 1967
38085c38110
< #line 1966
---
> #line 1967
38088c38113
< #line 1969
---
> #line 1970
38093c38118
< #line 2031 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2032 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
38099,38100d38123
< #line 2033
<   _drbd_thread_stop(thi, 0, 0);
38101a38125,38126
>   _drbd_thread_stop(thi, 0, 0);
> #line 2035
38105c38130
< #line 2036 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2037 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
38111,38112d38135
< #line 2038
<   _drbd_thread_stop(thi, 1, 0);
38113a38137,38138
>   _drbd_thread_stop(thi, 1, 0);
> #line 2040
38117c38142
< #line 2249 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2250 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
38123c38148
< #line 2251
---
> #line 2252
38125c38150
< #line 2256
---
> #line 2257
38148c38173
< #line 2281
---
> #line 2282
38151,38152d38175
< #line 2285
<   if (mdev->agreed_pro_version <= 95) {
38153a38177,38178
>   if (mdev->agreed_pro_version <= 95) {
> #line 2287
38158c38183
< #line 2287
---
> #line 2288
38163c38188
< #line 2294
---
> #line 2295
38167c38192
< #line 2297
---
> #line 2298
38174c38199
< #line 2304
---
> #line 2305
38181c38206
< #line 2313
---
> #line 2314
38185c38210
< #line 2316
---
> #line 2317
38189c38214
< #line 2324 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2325 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
38201c38226
< #line 2326
---
> #line 2327
38203c38228
< #line 2326
---
> #line 2327
38205c38230
< #line 2328
---
> #line 2329
38207,38208d38231
< #line 2328
<   if (tmp___0 != 0) {
38209a38233,38234
>   if (tmp___0 != 0) {
> #line 2330
38214c38239
< #line 2330
---
> #line 2331
38216,38217d38240
< #line 2330
<   if (tmp___1 != 0) {
38218a38242,38243
>   if (tmp___1 != 0) {
> #line 2332
38223c38248
< #line 2338
---
> #line 2339
38225,38226d38249
< #line 2338
<   if (tmp___2 == 0) {
38227a38251,38252
>   if (tmp___2 == 0) {
> #line 2340
38232c38257
< #line 2343
---
> #line 2344
38234,38235d38258
< #line 2343
<   if (tmp___3 > mxb) {
38236a38260,38261
>   if (tmp___3 > mxb) {
> #line 2345
38241c38266
< #line 2345
---
> #line 2346
38243,38244d38267
< #line 2345
<   if (tmp___4 != 0) {
38245a38269,38270
>   if (tmp___4 != 0) {
> #line 2347
38250c38275
< #line 2347
---
> #line 2348
38254c38279
< #line 2427 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2428 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
38260,38261d38284
< #line 2429
<   sk = (mdev->data.socket)->sk;
38263c38286
<   if (sk->sk_wmem_queued > (sk->sk_sndbuf * 4) / 5) {
---
>   sk = (mdev->data.socket)->sk;
38264a38288,38289
>   if (sk->sk_wmem_queued > (sk->sk_sndbuf * 4) / 5) {
> #line 2432
38269c38294
< #line 2432
---
> #line 2433
38273c38298
< #line 2434 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 2435 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
38279c38304
< #line 2441
---
> #line 2442
48191c48216
< #line 1917 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
---
> #line 1918 "/work/ldvuser/novikov/inst/current/envs/linux/linux/drivers/block/drbd/drbd_int.h"
48209c48234
< #line 1920
---
> #line 1921
48213c48238
< #line 1924
---
> #line 1925
48215c48240
< #line 1924
---
> #line 1925
48217c48242
< #line 1924
---
> #line 1925
48219c48244
< #line 1924
---
> #line 1925
48221c48246
< #line 1924
---
> #line 1925
48223c48248
< #line 1924
---
> #line 1925
48226c48251
< #line 1924
---
> #line 1925
48229c48254
< #line 1927
---
> #line 1928
48232c48257
< #line 1929
---
> #line 1930
48234c48259
< #line 1929
---
> #line 1930
48236c48261
< #line 1929
---
> #line 1930
48238c48263
< #line 1929
---
> #line 1930
48240c48265
< #line 1932
---
> #line 1933
48242c48267
< #line 1932
---
> #line 1933
48244c48269
< #line 1932
---
> #line 1933
48246c48271
< #line 1935
---
> #line 1936
48249c48274
< #line 1937
---
> #line 1938
48251c48276
< #line 1937
---
> #line 1938
48253c48278
< #line 1937
---
> #line 1938
48255c48280
< #line 1937
---
> #line 1938
48259c48284
< #line 1940
---
> #line 1941

4366c4366
< #line 1782 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 1783 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
13124a13125,13126
> #line 75 "include/asm/io.h"
> extern void *ioremap_wc(unsigned long offset , unsigned long size ) ;
13271a13274,13275
> #line 1312
> extern void drm_core_ioremap_wc(struct drm_map *map , struct drm_device *dev ) ;
13559c13563
<     tmp___2 = ioremap(pfn << 12, 1UL << 12);
---
>     tmp___2 = ioremap_wc(pfn << 12, 1UL << 12);
15771,15774c15775,15776
<       reloc_page = ioremap((dev->agp)->base + ((unsigned long )reloc_offset & ~ ((1UL << 12) - 1UL)),
<                            1UL << 12);
< #line 1618
<       last_reloc_offset = reloc_offset;
---
>       reloc_page = ioremap_wc((dev->agp)->base + ((unsigned long )reloc_offset & ~ ((1UL << 12) - 1UL)),
>                               1UL << 12);
15776c15778
<       if ((unsigned long )reloc_page == (unsigned long )((void *)0)) {
---
>       last_reloc_offset = reloc_offset;
15778c15780
<         drm_gem_object_unreference(target_obj);
---
>       if ((unsigned long )reloc_page == (unsigned long )((void *)0)) {
15780c15782
<         i915_gem_object_unpin(obj);
---
>         drm_gem_object_unreference(target_obj);
15781a15784,15785
>         i915_gem_object_unpin(obj);
> #line 1623
15789c15793
< #line 1626
---
> #line 1627
15791c15795
< #line 1628
---
> #line 1629
15793c15797
< #line 1635
---
> #line 1636
15795,15796d15798
< #line 1640
<     reloc.presumed_offset = target_obj_priv->gtt_offset;
15797a15800,15801
>     reloc.presumed_offset = target_obj_priv->gtt_offset;
> #line 1642
15799,15800d15802
< #line 1641
<     ret___0 = tmp___0;
15802c15804
<     if (ret___0 != 0) {
---
>     ret___0 = tmp___0;
15804c15806
<       drm_gem_object_unreference(target_obj);
---
>     if (ret___0 != 0) {
15806c15808
<       i915_gem_object_unpin(obj);
---
>       drm_gem_object_unreference(target_obj);
15807a15810,15811
>       i915_gem_object_unpin(obj);
> #line 1646
15812c15816
< #line 1648
---
> #line 1649
15818,15819d15821
< #line 1651
<   if ((unsigned long )reloc_page != (unsigned long )((void *)0)) {
15820a15823,15824
>   if ((unsigned long )reloc_page != (unsigned long )((void *)0)) {
> #line 1653
15825c15829
< #line 1658
---
> #line 1659
15829c15833
< #line 1663 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 1664 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
15848,15849d15851
< #line 1668
<   dev_priv = dev->dev_private;
15850a15853,15854
>   dev_priv = dev->dev_private;
> #line 1670
15852,15853d15855
< #line 1671
<   nbox = exec->num_cliprects;
15854a15857,15858
>   nbox = exec->num_cliprects;
> #line 1673
15856,15857d15859
< #line 1676
<   exec_start = (uint32_t )exec_offset + exec->batch_start_offset;
15858a15861,15862
>   exec_start = (uint32_t )exec_offset + exec->batch_start_offset;
> #line 1678
15860,15861d15863
< #line 1679
<   if ((exec_start | exec_len) & 7U) {
15863c15865
<     printk("<3>[drm:%s] *ERROR* alignment\n", "i915_dispatch_gem_execbuffer");
---
>   if ((exec_start | exec_len) & 7U) {
15864a15867,15868
>     printk("<3>[drm:%s] *ERROR* alignment\n", "i915_dispatch_gem_execbuffer");
> #line 1682
15869,15870d15872
< #line 1684
<   if (! exec_start) {
15871a15874,15875
>   if (! exec_start) {
> #line 1686
15876c15880
< #line 1687
---
> #line 1688
15878c15882
< #line 1689
---
> #line 1690
15880c15884
< #line 1689
---
> #line 1690
15882c15886
< #line 1689
---
> #line 1690
15886c15890
< #line 1689
---
> #line 1690
15889,15890d15892
< #line 1690
<     if (i < nbox) {
15891a15894,15895
>     if (i < nbox) {
> #line 1692
15893c15897
< #line 1691
---
> #line 1692
15895,15896d15898
< #line 1693
<       if (ret) {
15897a15900,15901
>       if (ret) {
> #line 1695
15905,15906d15908
< #line 1697
<     if (dev->pci_device == 13687 || dev->pci_device == 9570) {
15907a15910,15911
>     if (dev->pci_device == 13687 || dev->pci_device == 9570) {
> #line 1699
15909c15913
< #line 1698
---
> #line 1699
15911c15915
< #line 1698
---
> #line 1699
15916,15926d15919
< #line 1698
<         outcount = 0;
< #line 1698
<         outring = dev_priv->ring.tail;
< #line 1698
<         ringmask = dev_priv->ring.tail_mask;
< #line 1698
<         virt = dev_priv->ring.virtual_start;
< #line 1698
<         break;
<       }
15928,15930c15921
<       while (1) {
< #line 1699
<         *((unsigned int volatile   *)(virt + outring)) = (48 << 23) | 1;
---
>         outcount = 0;
15932c15923
<         outcount = outcount + 1U;
---
>         outring = dev_priv->ring.tail;
15934c15925
<         outring = outring + 4U;
---
>         ringmask = dev_priv->ring.tail_mask;
15936c15927
<         outring = outring & ringmask;
---
>         virt = dev_priv->ring.virtual_start;
15943c15934
<         *((unsigned int volatile   *)(virt + outring)) = exec_start | 1U;
---
>         *((unsigned int volatile   *)(virt + outring)) = (48 << 23) | 1;
15956c15947
<         *((unsigned int volatile   *)(virt + outring)) = (exec_start + exec_len) - (uint32_t )4;
---
>         *((unsigned int volatile   *)(virt + outring)) = exec_start | 1U;
15969c15960
<         *((unsigned int volatile   *)(virt + outring)) = 0;
---
>         *((unsigned int volatile   *)(virt + outring)) = (exec_start + exec_len) - (uint32_t )4;
15982c15973
<         dev_priv->ring.tail = outring;
---
>         *((unsigned int volatile   *)(virt + outring)) = 0;
15984c15975
<         dev_priv->ring.space = (unsigned int )dev_priv->ring.space - outcount * 4U;
---
>         outcount = outcount + 1U;
15986c15977
<         writel(outring, (dev_priv->mmio_map)->handle + 8240);
---
>         outring = outring + 4U;
15987a15979,15991
>         outring = outring & ringmask;
> #line 1703
>         break;
>       }
> #line 1704
>       while (1) {
> #line 1704
>         dev_priv->ring.tail = outring;
> #line 1704
>         dev_priv->ring.space = (unsigned int )dev_priv->ring.space - outcount * 4U;
> #line 1704
>         writel(outring, (dev_priv->mmio_map)->handle + 8240);
> #line 1704
15991c15995
< #line 1705
---
> #line 1706
15993c15997
< #line 1705
---
> #line 1706
15995c15999
< #line 1705
---
> #line 1706
16000c16004
< #line 1705
---
> #line 1706
16002c16006
< #line 1705
---
> #line 1706
16004c16008
< #line 1705
---
> #line 1706
16006c16010
< #line 1705
---
> #line 1706
16008c16012
< #line 1705
---
> #line 1706
16011,16012d16014
< #line 1706
<       if (((((((((dev->pci_device == 10610 || dev->pci_device == 10626) || dev->pci_device == 10642) || dev->pci_device == 10658) || dev->pci_device == 10754) || dev->pci_device == 10770) || dev->pci_device == 10818) || dev->pci_device == 11778) || dev->pci_device == 11794) || dev->pci_device == 11810) {
16013a16016,16017
>       if (((((((((dev->pci_device == 10610 || dev->pci_device == 10626) || dev->pci_device == 10642) || dev->pci_device == 10658) || dev->pci_device == 10754) || dev->pci_device == 10770) || dev->pci_device == 10818) || dev->pci_device == 11778) || dev->pci_device == 11794) || dev->pci_device == 11810) {
> #line 1708
16015c16019
< #line 1707
---
> #line 1708
16017c16021
< #line 1707
---
> #line 1708
16019c16023
< #line 1707
---
> #line 1708
16021c16025
< #line 1707
---
> #line 1708
16023c16027
< #line 1707
---
> #line 1708
16026c16030
< #line 1710
---
> #line 1711
16028c16032
< #line 1710
---
> #line 1711
16030c16034
< #line 1710
---
> #line 1711
16032c16036
< #line 1710
---
> #line 1711
16034c16038
< #line 1710
---
> #line 1711
16036c16040
< #line 1710
---
> #line 1711
16040c16044
< #line 1712
---
> #line 1713
16042c16046
< #line 1712
---
> #line 1713
16044c16048
< #line 1712
---
> #line 1713
16046c16050
< #line 1712
---
> #line 1713
16048c16052
< #line 1712
---
> #line 1713
16050c16054
< #line 1712
---
> #line 1713
16053c16057
< #line 1714
---
> #line 1715
16055c16059
< #line 1714
---
> #line 1715
16057c16061
< #line 1714
---
> #line 1715
16059c16063
< #line 1714
---
> #line 1715
16061c16065
< #line 1714
---
> #line 1715
16063c16067
< #line 1714
---
> #line 1715
16067c16071
< #line 1716
---
> #line 1717
16069c16073
< #line 1716
---
> #line 1717
16071c16075
< #line 1716
---
> #line 1717
16073c16077
< #line 1716
---
> #line 1717
16075c16079
< #line 1716
---
> #line 1717
16079c16083
< #line 1689
---
> #line 1690
16082c16086
< #line 1721
---
> #line 1722
16086c16090
< #line 1730 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 1731 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
16094,16095d16097
< #line 1733
<   i915_file_priv = file_priv->driver_priv;
16096a16099,16100
>   i915_file_priv = file_priv->driver_priv;
> #line 1735
16098,16099d16101
< #line 1737
<   mutex_lock_nested(& dev->struct_mutex, 0);
16101c16103
<   seqno = i915_file_priv->mm.last_gem_throttle_seqno;
---
>   mutex_lock_nested(& dev->struct_mutex, 0);
16102a16105,16106
>   seqno = i915_file_priv->mm.last_gem_throttle_seqno;
> #line 1740
16104,16105d16107
< #line 1741
<   if (seqno) {
16106a16109,16110
>   if (seqno) {
> #line 1743
16111,16112d16114
< #line 1743
<   mutex_unlock(& dev->struct_mutex);
16113a16116,16117
>   mutex_unlock(& dev->struct_mutex);
> #line 1745
16117c16121
< #line 1747 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 1748 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
16143,16144d16146
< #line 1751
<   dev_priv = dev->dev_private;
16146c16148
<   i915_file_priv = file_priv->driver_priv;
---
>   dev_priv = dev->dev_private;
16148c16150
<   args = data;
---
>   i915_file_priv = file_priv->driver_priv;
16150c16152
<   exec_list = (void *)0;
---
>   args = data;
16151a16154,16155
>   exec_list = (void *)0;
> #line 1756
16153c16157
< #line 1757
---
> #line 1758
16155,16156d16158
< #line 1766
<   if (args->buffer_count < (uint32_t )1) {
16157a16160,16161
>   if (args->buffer_count < (uint32_t )1) {
> #line 1768
16160c16164
< #line 1768
---
> #line 1769
16165c16169
< #line 1771
---
> #line 1772
16167c16171
< #line 1771
---
> #line 1772
16169c16173
< #line 1773
---
> #line 1774
16171c16175
< #line 1773
---
> #line 1774
16173,16174d16176
< #line 1775
<   if ((unsigned long )exec_list == (unsigned long )((void *)0) || (unsigned long )object_list == (unsigned long )((void *)0)) {
16175a16178,16179
>   if ((unsigned long )exec_list == (unsigned long )((void *)0) || (unsigned long )object_list == (unsigned long )((void *)0)) {
> #line 1777
16178,16179d16181
< #line 1779
<     ret = -12;
16180a16183,16184
>     ret = -12;
> #line 1781
16185c16189
< #line 1782
---
> #line 1783
16188c16192
< #line 1782
---
> #line 1783
16190,16191d16193
< #line 1786
<   if (ret != 0) {
16192a16195,16196
>   if (ret != 0) {
> #line 1788
16195c16199
< #line 1789
---
> #line 1790
16200c16204
< #line 1792
---
> #line 1793
16202,16203d16205
< #line 1796
<   if (dev_priv->mm.wedged) {
16205c16207
<     printk("<3>[drm:%s] *ERROR* Execbuf while wedged\n", "i915_gem_execbuffer");
---
>   if (dev_priv->mm.wedged) {
16207c16209
<     mutex_unlock(& dev->struct_mutex);
---
>     printk("<3>[drm:%s] *ERROR* Execbuf while wedged\n", "i915_gem_execbuffer");
16208a16211,16212
>     mutex_unlock(& dev->struct_mutex);
> #line 1800
16213,16214d16216
< #line 1802
<   if (dev_priv->mm.suspended) {
16216c16218
<     printk("<3>[drm:%s] *ERROR* Execbuf while VT-switched.\n", "i915_gem_execbuffer");
---
>   if (dev_priv->mm.suspended) {
16218c16220
<     mutex_unlock(& dev->struct_mutex);
---
>     printk("<3>[drm:%s] *ERROR* Execbuf while VT-switched.\n", "i915_gem_execbuffer");
16219a16222,16223
>     mutex_unlock(& dev->struct_mutex);
> #line 1806
16224,16225d16227
< #line 1812
<   dev->invalidate_domains = 0;
16226a16229,16230
>   dev->invalidate_domains = 0;
> #line 1814
16228c16232
< #line 1816
---
> #line 1817
16230c16234
< #line 1816
---
> #line 1817
16232c16236
< #line 1816
---
> #line 1817
16236c16240
< #line 1816
---
> #line 1817
16239c16243
< #line 1817
---
> #line 1818
16241,16242d16244
< #line 1819
<     if ((unsigned long )*(object_list + i) == (unsigned long )((void *)0)) {
16243a16246,16247
>     if ((unsigned long )*(object_list + i) == (unsigned long )((void *)0)) {
> #line 1821
16246,16247d16249
< #line 1822
<       ret = -9;
16248a16251,16252
>       ret = -9;
> #line 1824
16253,16254d16256
< #line 1826
<     (*(object_list + i))->pending_read_domains = 0;
16256c16258
<     (*(object_list + i))->pending_write_domain = 0;
---
>     (*(object_list + i))->pending_read_domains = 0;
16257a16260,16261
>     (*(object_list + i))->pending_write_domain = 0;
> #line 1829
16259,16260d16262
< #line 1831
<     if (ret) {
16261a16264,16265
>     if (ret) {
> #line 1833
16264c16268
< #line 1833
---
> #line 1834
16269c16273
< #line 1835
---
> #line 1836
16271c16275
< #line 1816
---
> #line 1817
16274,16275d16277
< #line 1839
<   batch_obj = *(object_list + (args->buffer_count - (uint32_t )1));
16277c16279
<   batch_obj->pending_read_domains = 8;
---
>   batch_obj = *(object_list + (args->buffer_count - (uint32_t )1));
16278a16281,16282
>   batch_obj->pending_read_domains = 8;
> #line 1842
16280c16284
< #line 1845
---
> #line 1846
16282c16286
< #line 1845
---
> #line 1846
16284c16288
< #line 1845
---
> #line 1846
16288c16292
< #line 1845
---
> #line 1846
16291,16292d16294
< #line 1846
<     obj = *(object_list + i);
16293a16296,16297
>     obj = *(object_list + i);
> #line 1848
16295c16299
< #line 1849
---
> #line 1850
16297,16298d16300
< #line 1855
<       ret = -12;
16299a16302,16303
>       ret = -12;
> #line 1857
16304c16308
< #line 1860
---
> #line 1861
16306,16307d16309
< #line 1863
<     if (ret) {
16308a16311,16312
>     if (ret) {
> #line 1865
16313c16317
< #line 1845
---
> #line 1846
16316c16320
< #line 1870
---
> #line 1871
16318c16322
< #line 1881
---
> #line 1882
16320c16324
< #line 1890
---
> #line 1891
16322,16323d16325
< #line 1893
<   ret = i915_dispatch_gem_execbuffer(dev, args, exec_offset);
16325c16327
<   if (ret) {
---
>   ret = i915_dispatch_gem_execbuffer(dev, args, exec_offset);
16327c16329
<     printk("<3>[drm:%s] *ERROR* dispatch failed %d\n", "i915_gem_execbuffer", ret);
---
>   if (ret) {
16328a16331,16332
>     printk("<3>[drm:%s] *ERROR* dispatch failed %d\n", "i915_gem_execbuffer", ret);
> #line 1897
16333c16337
< #line 1903
---
> #line 1904
16335,16336d16338
< #line 1914
<   seqno = i915_add_request(dev, flush_domains);
16337a16340,16341
>   seqno = i915_add_request(dev, flush_domains);
> #line 1916
16339c16343
< #line 1915
---
> #line 1916
16341c16345
< #line 1915
---
> #line 1916
16343c16347
< #line 1915
---
> #line 1916
16345c16349
< #line 1915
---
> #line 1916
16352,16353c16356,16357
<                              "i" (1915), "i" (sizeof(struct bug_entry )));
< #line 1915
---
>                              "i" (1916), "i" (sizeof(struct bug_entry )));
> #line 1916
16357c16361
< #line 1915
---
> #line 1916
16363c16367
< #line 1915
---
> #line 1916
16366,16367d16369
< #line 1916
<   i915_file_priv->mm.last_gem_seqno = seqno;
16368a16371,16372
>   i915_file_priv->mm.last_gem_seqno = seqno;
> #line 1918
16370c16374
< #line 1917
---
> #line 1918
16372c16376
< #line 1917
---
> #line 1918
16376c16380
< #line 1917
---
> #line 1918
16379,16380d16382
< #line 1918
<     obj___0 = *(object_list + i);
16381a16384,16385
>     obj___0 = *(object_list + i);
> #line 1920
16383,16384d16386
< #line 1921
<     i915_gem_object_move_to_active(obj___0);
16385a16388,16389
>     i915_gem_object_move_to_active(obj___0);
> #line 1923
16387c16391
< #line 1917
---
> #line 1918
16390c16394
< #line 1934
---
> #line 1935
16393c16397
< #line 1934
---
> #line 1935
16395,16396d16398
< #line 1938
<   if (ret) {
16397a16400,16401
>   if (ret) {
> #line 1940
16404,16405d16407
< #line 1943
<   if ((unsigned long )object_list != (unsigned long )((void *)0)) {
16406a16409,16410
>   if ((unsigned long )object_list != (unsigned long )((void *)0)) {
> #line 1945
16408c16412
< #line 1944
---
> #line 1945
16410c16414
< #line 1944
---
> #line 1945
16414c16418
< #line 1944
---
> #line 1945
16417c16421
< #line 1945
---
> #line 1946
16419c16423
< #line 1944
---
> #line 1945
16422c16426
< #line 1947
---
> #line 1948
16424c16428
< #line 1947
---
> #line 1948
16426c16430
< #line 1947
---
> #line 1948
16430c16434
< #line 1947
---
> #line 1948
16433c16437
< #line 1948
---
> #line 1949
16435c16439
< #line 1947
---
> #line 1948
16441c16445
< #line 1950
---
> #line 1951
16444c16448
< #line 1953
---
> #line 1954
16447c16451
< #line 1955
---
> #line 1956
16449c16453
< #line 1958
---
> #line 1959
16453c16457
< #line 1961 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 1962 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
16462,16463d16465
< #line 1964
<   dev = obj->dev;
16464a16467,16468
>   dev = obj->dev;
> #line 1966
16466,16467d16469
< #line 1969
<   if ((unsigned long )obj_priv->gtt_space == (unsigned long )((void *)0)) {
16469c16471
<     ret = i915_gem_object_bind_to_gtt(obj, alignment);
---
>   if ((unsigned long )obj_priv->gtt_space == (unsigned long )((void *)0)) {
16471c16473
<     if (ret != 0) {
---
>     ret = i915_gem_object_bind_to_gtt(obj, alignment);
16473c16475
<       printk("<3>[drm:%s] *ERROR* Failure to bind: %d", "i915_gem_object_pin", ret);
---
>     if (ret != 0) {
16474a16477,16478
>       printk("<3>[drm:%s] *ERROR* Failure to bind: %d", "i915_gem_object_pin", ret);
> #line 1974
16482c16486
< #line 1976
---
> #line 1977
16484,16485d16487
< #line 1981
<   if (obj_priv->pin_count == 1) {
16487c16489
<     atomic_inc(& dev->pin_count);
---
>   if (obj_priv->pin_count == 1) {
16489c16491
<     atomic_add(obj->size, & dev->pin_memory);
---
>     atomic_inc(& dev->pin_count);
16490a16493,16494
>     atomic_add(obj->size, & dev->pin_memory);
> #line 1985
16492c16496
< #line 1984
---
> #line 1985
16494c16498
< #line 1984
---
> #line 1985
16498c16502
< #line 1988
---
> #line 1989
16507c16511
< #line 1992
---
> #line 1993
16511c16515
< #line 1995 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 1996 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
16521,16522d16524
< #line 1998
<   dev = obj->dev;
16524c16526
<   dev_priv = dev->dev_private;
---
>   dev = obj->dev;
16525a16528,16529
>   dev_priv = dev->dev_private;
> #line 2001
16527,16528d16530
< #line 2003
<   obj_priv->pin_count = obj_priv->pin_count - 1;
16529a16532,16533
>   obj_priv->pin_count = obj_priv->pin_count - 1;
> #line 2005
16531c16535
< #line 2004
---
> #line 2005
16533c16537
< #line 2004
---
> #line 2005
16535c16539
< #line 2004
---
> #line 2005
16537c16541
< #line 2004
---
> #line 2005
16544,16545c16548,16549
<                              "i" (2004), "i" (sizeof(struct bug_entry )));
< #line 2004
---
>                              "i" (2005), "i" (sizeof(struct bug_entry )));
> #line 2005
16549c16553
< #line 2004
---
> #line 2005
16555c16559
< #line 2004
---
> #line 2005
16558c16562
< #line 2005
---
> #line 2006
16560c16564
< #line 2005
---
> #line 2006
16563c16567
< #line 2005
---
> #line 2006
16565c16569
< #line 2005
---
> #line 2006
16567c16571
< #line 2005
---
> #line 2006
16574,16575c16578,16579
<                              "i" (2005), "i" (sizeof(struct bug_entry )));
< #line 2005
---
>                              "i" (2006), "i" (sizeof(struct bug_entry )));
> #line 2006
16579c16583
< #line 2005
---
> #line 2006
16585c16589
< #line 2005
---
> #line 2006
16588,16589d16591
< #line 2011
<   if (obj_priv->pin_count == 0) {
16590a16593,16594
>   if (obj_priv->pin_count == 0) {
> #line 2013
16592c16596
< #line 2015
---
> #line 2016
16597,16598d16600
< #line 2017
<     atomic_dec(& dev->pin_count);
16599a16602,16603
>     atomic_dec(& dev->pin_count);
> #line 2019
16604c16608
< #line 2021
---
> #line 2022
16608c16612
< #line 2023 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2024 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
16617c16621
< #line 2027
---
> #line 2028
16619c16623
< #line 2032
---
> #line 2033
16621,16622d16624
< #line 2034
<   obj = drm_gem_object_lookup(dev, file_priv, args->handle);
16624c16626
<   if ((unsigned long )obj == (unsigned long )((void *)0)) {
---
>   obj = drm_gem_object_lookup(dev, file_priv, args->handle);
16625a16628,16629
>   if ((unsigned long )obj == (unsigned long )((void *)0)) {
> #line 2037
16628,16629d16631
< #line 2038
<     mutex_unlock(& dev->struct_mutex);
16630a16633,16634
>     mutex_unlock(& dev->struct_mutex);
> #line 2040
16635c16639
< #line 2041
---
> #line 2042
16637,16638d16640
< #line 2043
<   ret = i915_gem_object_pin(obj, args->alignment);
16640c16642
<   if (ret != 0) {
---
>   ret = i915_gem_object_pin(obj, args->alignment);
16642c16644
<     drm_gem_object_unreference(obj);
---
>   if (ret != 0) {
16644c16646
<     mutex_unlock(& dev->struct_mutex);
---
>     drm_gem_object_unreference(obj);
16645a16648,16649
>     mutex_unlock(& dev->struct_mutex);
> #line 2048
16650,16651d16653
< #line 2053
<   if (obj->write_domain & 1U) {
16653c16655
<     i915_gem_clflush_object(obj);
---
>   if (obj->write_domain & 1U) {
16655c16657
<     drm_agp_chipset_flush(dev);
---
>     i915_gem_clflush_object(obj);
16656a16659,16660
>     drm_agp_chipset_flush(dev);
> #line 2057
16661,16662d16664
< #line 2058
<   args->offset = obj_priv->gtt_offset;
16664c16666
<   drm_gem_object_unreference(obj);
---
>   args->offset = obj_priv->gtt_offset;
16665a16668,16669
>   drm_gem_object_unreference(obj);
> #line 2061
16667c16671
< #line 2062
---
> #line 2063
16671c16675
< #line 2065 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2066 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
16678c16682
< #line 2069
---
> #line 2070
16680c16684
< #line 2072
---
> #line 2073
16682,16683d16685
< #line 2074
<   obj = drm_gem_object_lookup(dev, file_priv, args->handle);
16685c16687
<   if ((unsigned long )obj == (unsigned long )((void *)0)) {
---
>   obj = drm_gem_object_lookup(dev, file_priv, args->handle);
16686a16689,16690
>   if ((unsigned long )obj == (unsigned long )((void *)0)) {
> #line 2077
16689,16690d16692
< #line 2078
<     mutex_unlock(& dev->struct_mutex);
16691a16694,16695
>     mutex_unlock(& dev->struct_mutex);
> #line 2080
16696c16700
< #line 2082
---
> #line 2083
16698,16699d16701
< #line 2084
<   drm_gem_object_unreference(obj);
16701c16703
<   mutex_unlock(& dev->struct_mutex);
---
>   drm_gem_object_unreference(obj);
16702a16705,16706
>   mutex_unlock(& dev->struct_mutex);
> #line 2087
16706c16710
< #line 2089 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2090 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
16714c16718
< #line 2093
---
> #line 2094
16716,16717d16719
< #line 2097
<   mutex_lock_nested(& dev->struct_mutex, 0);
16719c16721
<   obj = drm_gem_object_lookup(dev, file_priv, args->handle);
---
>   mutex_lock_nested(& dev->struct_mutex, 0);
16721c16723
<   if ((unsigned long )obj == (unsigned long )((void *)0)) {
---
>   obj = drm_gem_object_lookup(dev, file_priv, args->handle);
16722a16725,16726
>   if ((unsigned long )obj == (unsigned long )((void *)0)) {
> #line 2101
16725,16726d16728
< #line 2102
<     mutex_unlock(& dev->struct_mutex);
16727a16730,16731
>     mutex_unlock(& dev->struct_mutex);
> #line 2104
16732,16733d16735
< #line 2106
<   obj_priv = obj->driver_private;
16734a16737,16738
>   obj_priv = obj->driver_private;
> #line 2108
16736,16737d16739
< #line 2109
<   drm_gem_object_unreference(obj);
16739c16741
<   mutex_unlock(& dev->struct_mutex);
---
>   drm_gem_object_unreference(obj);
16740a16743,16744
>   mutex_unlock(& dev->struct_mutex);
> #line 2112
16744c16748
< #line 2114 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2115 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
16750c16754
< #line 2118
---
> #line 2119
16752c16756
< #line 2118
---
> #line 2119
16756c16760
< #line 2121 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2122 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
16763c16767
< #line 2125
---
> #line 2126
16765,16766d16768
< #line 2125
<   obj_priv = tmp;
16768c16770
<   if ((unsigned long )obj_priv == (unsigned long )((void *)0)) {
---
>   obj_priv = tmp;
16769a16772,16773
>   if ((unsigned long )obj_priv == (unsigned long )((void *)0)) {
> #line 2128
16774,16775d16777
< #line 2135
<   obj->write_domain = 1;
16776a16779,16780
>   obj->write_domain = 1;
> #line 2137
16778,16779d16781
< #line 2138
<   obj->driver_private = obj_priv;
16781c16783
<   obj_priv->obj = obj;
---
>   obj->driver_private = obj_priv;
16783c16785
<   INIT_LIST_HEAD(& obj_priv->list);
---
>   obj_priv->obj = obj;
16784a16787,16788
>   INIT_LIST_HEAD(& obj_priv->list);
> #line 2142
16788c16792
< #line 2144 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2145 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
16794c16798
< #line 2146
---
> #line 2147
16796c16800
< #line 2148
---
> #line 2149
16798c16802
< #line 2148
---
> #line 2149
16802c16806
< #line 2148
---
> #line 2149
16805c16809
< #line 2149
---
> #line 2150
16808c16812
< #line 2151
---
> #line 2152
16810,16811d16813
< #line 2153
<   drm_free(obj_priv->page_cpu_valid, 1, 2);
16813c16815
<   drm_free(obj->driver_private, 1, 2);
---
>   drm_free(obj_priv->page_cpu_valid, 1, 2);
16814a16817,16818
>   drm_free(obj->driver_private, 1, 2);
> #line 2156
16818c16822
< #line 2157 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2158 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
16830c16834
< #line 2163
---
> #line 2164
16832c16836
< #line 2167
---
> #line 2168
16834c16838
< #line 2167
---
> #line 2168
16836c16840
< #line 2167
---
> #line 2168
16838c16842
< #line 2167
---
> #line 2168
16841c16845
< #line 2167
---
> #line 2168
16844c16848
< #line 2167
---
> #line 2168
16846c16850
< #line 2167
---
> #line 2168
16848c16852
< #line 2167
---
> #line 2168
16850c16854
< #line 2167
---
> #line 2168
16857,16858c16861,16862
<                              "i" (2167), "i" (sizeof(struct bug_entry )));
< #line 2167
---
>                              "i" (2168), "i" (sizeof(struct bug_entry )));
> #line 2168
16862c16866
< #line 2167
---
> #line 2168
16868c16872
< #line 2167
---
> #line 2168
16871,16872d16874
< #line 2169
<   ret = i915_gem_object_set_domain(obj, read_domains, write_domain);
16874c16876
<   if (ret) {
---
>   ret = i915_gem_object_set_domain(obj, read_domains, write_domain);
16875a16878,16879
>   if (ret) {
> #line 2172
16880c16884
< #line 2172
---
> #line 2173
16882,16883d16885
< #line 2174
<   if (flush_domains & (unsigned int )(~ (1 | 64))) {
16884a16887,16888
>   if (flush_domains & (unsigned int )(~ (1 | 64))) {
> #line 2176
16889c16893
< #line 2177
---
> #line 2178
16893c16897
< #line 2181 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2182 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
16903c16907
< #line 2188
---
> #line 2189
16905c16909
< #line 2188
---
> #line 2189
16907c16911
< #line 2188
---
> #line 2189
16909c16913
< #line 2188
---
> #line 2189
16914c16918
< #line 2189
---
> #line 2190
16916c16920
< #line 2189
---
> #line 2190
16918c16922
< #line 2192
---
> #line 2193
16920,16921d16923
< #line 2194
<     if (obj_priv->pin_count != 0) {
16923c16925
<       printk("<3>[drm:%s] *ERROR* Pinned object in unbind list\n", "i915_gem_evict_from_list");
---
>     if (obj_priv->pin_count != 0) {
16925c16927
<       mutex_unlock(& dev->struct_mutex);
---
>       printk("<3>[drm:%s] *ERROR* Pinned object in unbind list\n", "i915_gem_evict_from_list");
16926a16929,16930
>       mutex_unlock(& dev->struct_mutex);
> #line 2198
16931,16932d16934
< #line 2200
<     ret = i915_gem_object_unbind(obj);
16934c16936
<     if (ret != 0) {
---
>     ret = i915_gem_object_unbind(obj);
16935a16938,16939
>     if (ret != 0) {
> #line 2203
16938,16939d16941
< #line 2204
<       mutex_unlock(& dev->struct_mutex);
16940a16943,16944
>       mutex_unlock(& dev->struct_mutex);
> #line 2206
16946c16950
< #line 2210
---
> #line 2211
16950c16954
< #line 2213 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2214 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
16984c16988
< #line 2216
---
> #line 2217
16986,16987d16989
< #line 2220
<   if (dev_priv->mm.suspended) {
16988a16991,16992
>   if (dev_priv->mm.suspended) {
> #line 2222
16993c16997
< #line 2226
---
> #line 2227
16995c16999
< #line 2228
---
> #line 2229
16997c17001
< #line 2232
---
> #line 2233
16999c17003
< #line 2234
---
> #line 2235
17001,17002d17004
< #line 2237
<   if (seqno == (uint32_t )0) {
17004c17006
<     mutex_unlock(& dev->struct_mutex);
---
>   if (seqno == (uint32_t )0) {
17005a17008,17009
>     mutex_unlock(& dev->struct_mutex);
> #line 2240
17010,17011d17013
< #line 2242
<   dev_priv->mm.waiting_gem_seqno = seqno;
17013c17015
<   last_seqno = 0;
---
>   dev_priv->mm.waiting_gem_seqno = seqno;
17015c17017
<   stuck = 0;
---
>   last_seqno = 0;
17017c17019
<   while (1) {
---
>   stuck = 0;
17019c17021
<     cur_seqno = i915_get_gem_seqno(dev);
---
>   while (1) {
17020a17023,17024
>     cur_seqno = i915_get_gem_seqno(dev);
> #line 2248
17022,17023d17025
< #line 2247
<     if (tmp) {
17024a17027,17028
>     if (tmp) {
> #line 2249
17029,17030d17032
< #line 2249
<     if (last_seqno == cur_seqno) {
17031a17034,17035
>     if (last_seqno == cur_seqno) {
> #line 2251
17033c17037
< #line 2250
---
> #line 2251
17035,17036d17038
< #line 2250
<       if (tmp___0 > 100) {
17038c17040
<         printk("<3>[drm:%s] *ERROR* hardware wedged\n", "i915_gem_idle");
---
>       if (tmp___0 > 100) {
17040c17042
<         dev_priv->mm.wedged = 1;
---
>         printk("<3>[drm:%s] *ERROR* hardware wedged\n", "i915_gem_idle");
17042c17044
<         __wake_up(& dev_priv->irq_queue, 1, 1, (void *)0);
---
>         dev_priv->mm.wedged = 1;
17043a17046,17047
>         __wake_up(& dev_priv->irq_queue, 1, 1, (void *)0);
> #line 2255
17051,17052d17054
< #line 2257
<     msleep(10);
17053a17056,17057
>     msleep(10);
> #line 2259
17056c17060
< #line 2260
---
> #line 2261
17058c17062
< #line 2262
---
> #line 2263
17060c17064
< #line 2267
---
> #line 2268
17062c17066
< #line 2267
---
> #line 2268
17064c17068
< #line 2267
---
> #line 2268
17066c17070
< #line 2267
---
> #line 2268
17069c17073
< #line 2267
---
> #line 2268
17072c17076
< #line 2267
---
> #line 2268
17074c17078
< #line 2267
---
> #line 2268
17076c17080
< #line 2267
---
> #line 2268
17078c17082
< #line 2267
---
> #line 2268
17085,17086c17089,17090
<                              "i" (2267), "i" (sizeof(struct bug_entry )));
< #line 2267
---
>                              "i" (2268), "i" (sizeof(struct bug_entry )));
> #line 2268
17090c17094
< #line 2267
---
> #line 2268
17096c17100
< #line 2267
---
> #line 2268
17099c17103
< #line 2268
---
> #line 2269
17101c17105
< #line 2268
---
> #line 2269
17103c17107
< #line 2268
---
> #line 2269
17105c17109
< #line 2268
---
> #line 2269
17108c17112
< #line 2268
---
> #line 2269
17111c17115
< #line 2268
---
> #line 2269
17113c17117
< #line 2268
---
> #line 2269
17115c17119
< #line 2268
---
> #line 2269
17117c17121
< #line 2268
---
> #line 2269
17124,17125c17128,17129
<                              "i" (2268), "i" (sizeof(struct bug_entry )));
< #line 2268
---
>                              "i" (2269), "i" (sizeof(struct bug_entry )));
> #line 2269
17129c17133
< #line 2268
---
> #line 2269
17135c17139
< #line 2268
---
> #line 2269
17138c17142
< #line 2273
---
> #line 2274
17140c17144
< #line 2273
---
> #line 2274
17142c17146
< #line 2273
---
> #line 2274
17144c17148
< #line 2273
---
> #line 2274
17147c17151
< #line 2273
---
> #line 2274
17150c17154
< #line 2273
---
> #line 2274
17152c17156
< #line 2273
---
> #line 2274
17154c17158
< #line 2273
---
> #line 2274
17156c17160
< #line 2273
---
> #line 2274
17163,17164c17167,17168
<                              "i" (2273), "i" (sizeof(struct bug_entry )));
< #line 2273
---
>                              "i" (2274), "i" (sizeof(struct bug_entry )));
> #line 2274
17168c17172
< #line 2273
---
> #line 2274
17174c17178
< #line 2273
---
> #line 2274
17177,17178d17180
< #line 2276
<   ret = i915_gem_evict_from_list(dev, & dev_priv->mm.inactive_list);
17180c17182
<   if (ret) {
---
>   ret = i915_gem_evict_from_list(dev, & dev_priv->mm.inactive_list);
17181a17184,17185
>   if (ret) {
> #line 2279
17186c17190
< #line 2280
---
> #line 2281
17188c17192
< #line 2280
---
> #line 2281
17190c17194
< #line 2280
---
> #line 2281
17192c17196
< #line 2280
---
> #line 2281
17195c17199
< #line 2280
---
> #line 2281
17198c17202
< #line 2280
---
> #line 2281
17200c17204
< #line 2280
---
> #line 2281
17202c17206
< #line 2280
---
> #line 2281
17204c17208
< #line 2280
---
> #line 2281
17211,17212c17215,17216
<                              "i" (2280), "i" (sizeof(struct bug_entry )));
< #line 2280
---
>                              "i" (2281), "i" (sizeof(struct bug_entry )));
> #line 2281
17216c17220
< #line 2280
---
> #line 2281
17222c17226
< #line 2280
---
> #line 2281
17225c17229
< #line 2281
---
> #line 2282
17227c17231
< #line 2281
---
> #line 2282
17229c17233
< #line 2281
---
> #line 2282
17231c17235
< #line 2281
---
> #line 2282
17234c17238
< #line 2281
---
> #line 2282
17237c17241
< #line 2281
---
> #line 2282
17239c17243
< #line 2281
---
> #line 2282
17241c17245
< #line 2281
---
> #line 2282
17243c17247
< #line 2281
---
> #line 2282
17250,17251c17254,17255
<                              "i" (2281), "i" (sizeof(struct bug_entry )));
< #line 2281
---
>                              "i" (2282), "i" (sizeof(struct bug_entry )));
> #line 2282
17255c17259
< #line 2281
---
> #line 2282
17261c17265
< #line 2281
---
> #line 2282
17264c17268
< #line 2282
---
> #line 2283
17266c17270
< #line 2282
---
> #line 2283
17268c17272
< #line 2282
---
> #line 2283
17270c17274
< #line 2282
---
> #line 2283
17273c17277
< #line 2282
---
> #line 2283
17276c17280
< #line 2282
---
> #line 2283
17278c17282
< #line 2282
---
> #line 2283
17280c17284
< #line 2282
---
> #line 2283
17282c17286
< #line 2282
---
> #line 2283
17289,17290c17293,17294
<                              "i" (2282), "i" (sizeof(struct bug_entry )));
< #line 2282
---
>                              "i" (2283), "i" (sizeof(struct bug_entry )));
> #line 2283
17294c17298
< #line 2282
---
> #line 2283
17300c17304
< #line 2282
---
> #line 2283
17303c17307
< #line 2283
---
> #line 2284
17305c17309
< #line 2283
---
> #line 2284
17307c17311
< #line 2283
---
> #line 2284
17309c17313
< #line 2283
---
> #line 2284
17312c17316
< #line 2283
---
> #line 2284
17315c17319
< #line 2283
---
> #line 2284
17317c17321
< #line 2283
---
> #line 2284
17319c17323
< #line 2283
---
> #line 2284
17321c17325
< #line 2283
---
> #line 2284
17328,17329c17332,17333
<                              "i" (2283), "i" (sizeof(struct bug_entry )));
< #line 2283
---
>                              "i" (2284), "i" (sizeof(struct bug_entry )));
> #line 2284
17333c17337
< #line 2283
---
> #line 2284
17339c17343
< #line 2283
---
> #line 2284
17342c17346
< #line 2284
---
> #line 2285
17346c17350
< #line 2287 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2288 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
17355c17359
< #line 2290
---
> #line 2291
17357,17358d17360
< #line 2298
<   if (! ((((dev->pci_device == 10690 || dev->pci_device == 10674) || dev->pci_device == 10706) || dev->pci_device == 10818) || ((dev->pci_device == 11778 || dev->pci_device == 11794) || dev->pci_device == 11810))) {
17359a17362,17363
>   if (! ((((dev->pci_device == 10690 || dev->pci_device == 10674) || dev->pci_device == 10706) || dev->pci_device == 10818) || ((dev->pci_device == 11778 || dev->pci_device == 11794) || dev->pci_device == 11810))) {
> #line 2300
17364,17365d17367
< #line 2301
<   obj = drm_gem_object_alloc(dev, 4096);
17367c17369
<   if ((unsigned long )obj == (unsigned long )((void *)0)) {
---
>   obj = drm_gem_object_alloc(dev, 4096);
17369c17371
<     printk("<3>[drm:%s] *ERROR* Failed to allocate status page\n", "i915_gem_init_hws");
---
>   if ((unsigned long )obj == (unsigned long )((void *)0)) {
17370a17373,17374
>     printk("<3>[drm:%s] *ERROR* Failed to allocate status page\n", "i915_gem_init_hws");
> #line 2305
17375c17379
< #line 2306
---
> #line 2307
17377,17378d17380
< #line 2308
<   ret = i915_gem_object_pin(obj, 4096);
17380c17382
<   if (ret != 0) {
---
>   ret = i915_gem_object_pin(obj, 4096);
17382c17384
<     drm_gem_object_unreference(obj);
---
>   if (ret != 0) {
17383a17386,17387
>     drm_gem_object_unreference(obj);
> #line 2312
17388,17389d17391
< #line 2314
<   dev_priv->status_gfx_addr = obj_priv->gtt_offset;
17391c17393
<   dev_priv->hws_map.offset = (dev->agp)->base + (unsigned long )obj_priv->gtt_offset;
---
>   dev_priv->status_gfx_addr = obj_priv->gtt_offset;
17393c17395
<   dev_priv->hws_map.size = 4096;
---
>   dev_priv->hws_map.offset = (dev->agp)->base + (unsigned long )obj_priv->gtt_offset;
17395c17397
<   dev_priv->hws_map.type = 0;
---
>   dev_priv->hws_map.size = 4096;
17397c17399
<   dev_priv->hws_map.flags = 0;
---
>   dev_priv->hws_map.type = 0;
17398a17401,17402
>   dev_priv->hws_map.flags = 0;
> #line 2320
17400,17402c17404,17406
< #line 2321
<   drm_core_ioremap(& dev_priv->hws_map, dev);
< #line 2322
---
> #line 2324
>   drm_core_ioremap_wc(& dev_priv->hws_map, dev);
> #line 2325
17404c17408
< #line 2323
---
> #line 2326
17406c17410
< #line 2324
---
> #line 2327
17408c17412
< #line 2325
---
> #line 2328
17410c17414
< #line 2326
---
> #line 2329
17415c17419
< #line 2328
---
> #line 2331
17417c17421
< #line 2329
---
> #line 2332
17419c17423
< #line 2330
---
> #line 2333
17421c17425
< #line 2331
---
> #line 2334
17423c17427
< #line 2332
---
> #line 2335
17425c17429
< #line 2332
---
> #line 2335
17427c17431
< #line 2332
---
> #line 2335
17432c17436
< #line 2332
---
> #line 2335
17435c17439
< #line 2334
---
> #line 2337
17439c17443
< #line 2337 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2340 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
17448c17452
< #line 2340
---
> #line 2343
17450c17454
< #line 2345
---
> #line 2348
17452c17456
< #line 2346
---
> #line 2349
17454c17458
< #line 2347
---
> #line 2350
17459c17463
< #line 2349
---
> #line 2352
17461c17465
< #line 2350
---
> #line 2353
17463c17467
< #line 2351
---
> #line 2354
17465c17469
< #line 2352
---
> #line 2355
17470c17474
< #line 2354
---
> #line 2357
17472c17476
< #line 2356
---
> #line 2359
17474c17478
< #line 2357
---
> #line 2360
17476c17480
< #line 2358
---
> #line 2361
17478c17482
< #line 2359
---
> #line 2362
17483c17487
< #line 2363
---
> #line 2366
17485c17489
< #line 2364
---
> #line 2367
17487c17491
< #line 2366
---
> #line 2369
17489c17493
< #line 2367
---
> #line 2370
17491c17495
< #line 2368
---
> #line 2371
17493,17496d17496
< #line 2369
<   dev_priv->ring.map.flags = 0;
< #line 2370
<   dev_priv->ring.map.mtrr = 0;
17498c17498
<   drm_core_ioremap(& dev_priv->ring.map, dev);
---
>   dev_priv->ring.map.flags = 0;
17499a17500,17503
>   dev_priv->ring.map.mtrr = 0;
> #line 2375
>   drm_core_ioremap_wc(& dev_priv->ring.map, dev);
> #line 2376
17501c17505
< #line 2374
---
> #line 2377
17503c17507
< #line 2375
---
> #line 2378
17505c17509
< #line 2376
---
> #line 2379
17507c17511
< #line 2377
---
> #line 2380
17512c17516
< #line 2379
---
> #line 2382
17514,17515d17517
< #line 2380
<   dev_priv->ring.virtual_start = dev_priv->ring.map.handle;
17516a17519,17520
>   dev_priv->ring.virtual_start = dev_priv->ring.map.handle;
> #line 2386
17518c17522
< #line 2384
---
> #line 2387
17520c17524
< #line 2385
---
> #line 2388
17522,17523d17525
< #line 2386
<   writel(0, (dev_priv->mmio_map)->handle + 8248);
17524a17527,17528
>   writel(0, (dev_priv->mmio_map)->handle + 8248);
> #line 2392
17526c17530
< #line 2390
---
> #line 2393
17528c17532
< #line 2396
---
> #line 2399
17530c17534
< #line 2398
---
> #line 2401
17534c17538
< #line 2401 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2404 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
17540c17544
< #line 2404
---
> #line 2407
17542c17546
< #line 2406
---
> #line 2409
17544c17548
< #line 2407
---
> #line 2410
17549c17553
< #line 2409
---
> #line 2412
17551c17555
< #line 2411
---
> #line 2414
17553c17557
< #line 2412
---
> #line 2415
17555c17559
< #line 2413
---
> #line 2416
17557c17561
< #line 2414
---
> #line 2417
17559c17563
< #line 2416
---
> #line 2419
17561c17565
< #line 2417
---
> #line 2420
17563c17567
< #line 2418
---
> #line 2421
17565c17569
< #line 2419
---
> #line 2422
17567,17568d17570
< #line 2420
<     memset(& dev_priv->hws_map, 0, sizeof(dev_priv->hws_map));
17569a17572,17573
>     memset(& dev_priv->hws_map, 0, sizeof(dev_priv->hws_map));
> #line 2426
17574c17578
< #line 2425
---
> #line 2428
17578c17582
< #line 2427 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2430 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
17597,17598d17600
< #line 2431
<   dev_priv = dev->dev_private;
17599a17602,17603
>   dev_priv = dev->dev_private;
> #line 2437
17601c17605
< #line 2435
---
> #line 2438
17603c17607
< #line 2436
---
> #line 2439
17608c17612
< #line 2439
---
> #line 2442
17610c17614
< #line 2440
---
> #line 2443
17612c17616
< #line 2441
---
> #line 2444
17617c17621
< #line 2443
---
> #line 2446
17619c17623
< #line 2444
---
> #line 2447
17621c17625
< #line 2444
---
> #line 2447
17623c17627
< #line 2444
---
> #line 2447
17625c17629
< #line 2444
---
> #line 2447
17628c17632
< #line 2444
---
> #line 2447
17631c17635
< #line 2444
---
> #line 2447
17633c17637
< #line 2444
---
> #line 2447
17635c17639
< #line 2444
---
> #line 2447
17637c17641
< #line 2444
---
> #line 2447
17644,17645c17648,17649
<                              "i" (2444), "i" (sizeof(struct bug_entry )));
< #line 2444
---
>                              "i" (2447), "i" (sizeof(struct bug_entry )));
> #line 2447
17649c17653
< #line 2444
---
> #line 2447
17655c17659
< #line 2444
---
> #line 2447
17658c17662
< #line 2445
---
> #line 2448
17660c17664
< #line 2445
---
> #line 2448
17662c17666
< #line 2445
---
> #line 2448
17664c17668
< #line 2445
---
> #line 2448
17667c17671
< #line 2445
---
> #line 2448
17670c17674
< #line 2445
---
> #line 2448
17672c17676
< #line 2445
---
> #line 2448
17674c17678
< #line 2445
---
> #line 2448
17676c17680
< #line 2445
---
> #line 2448
17683,17684c17687,17688
<                              "i" (2445), "i" (sizeof(struct bug_entry )));
< #line 2445
---
>                              "i" (2448), "i" (sizeof(struct bug_entry )));
> #line 2448
17688c17692
< #line 2445
---
> #line 2448
17694c17698
< #line 2445
---
> #line 2448
17697c17701
< #line 2446
---
> #line 2449
17699c17703
< #line 2446
---
> #line 2449
17701c17705
< #line 2446
---
> #line 2449
17703c17707
< #line 2446
---
> #line 2449
17706c17710
< #line 2446
---
> #line 2449
17709c17713
< #line 2446
---
> #line 2449
17711c17715
< #line 2446
---
> #line 2449
17713c17717
< #line 2446
---
> #line 2449
17715c17719
< #line 2446
---
> #line 2449
17722,17723c17726,17727
<                              "i" (2446), "i" (sizeof(struct bug_entry )));
< #line 2446
---
>                              "i" (2449), "i" (sizeof(struct bug_entry )));
> #line 2449
17727c17731
< #line 2446
---
> #line 2449
17733c17737
< #line 2446
---
> #line 2449
17736c17740
< #line 2447
---
> #line 2450
17738c17742
< #line 2447
---
> #line 2450
17740c17744
< #line 2447
---
> #line 2450
17742c17746
< #line 2447
---
> #line 2450
17745c17749
< #line 2447
---
> #line 2450
17748c17752
< #line 2447
---
> #line 2450
17750c17754
< #line 2447
---
> #line 2450
17752c17756
< #line 2447
---
> #line 2450
17754c17758
< #line 2447
---
> #line 2450
17761,17762c17765,17766
<                              "i" (2447), "i" (sizeof(struct bug_entry )));
< #line 2447
---
>                              "i" (2450), "i" (sizeof(struct bug_entry )));
> #line 2450
17766c17770
< #line 2447
---
> #line 2450
17772c17776
< #line 2447
---
> #line 2450
17775c17779
< #line 2448
---
> #line 2451
17777c17781
< #line 2449
---
> #line 2452
17779c17783
< #line 2451
---
> #line 2454
17781c17785
< #line 2453
---
> #line 2456
17785c17789
< #line 2456 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2459 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
17791c17795
< #line 2462
---
> #line 2465
17793c17797
< #line 2463
---
> #line 2466
17795c17799
< #line 2464
---
> #line 2467
17797c17801
< #line 2465
---
> #line 2468
17802c17806
< #line 2466
---
> #line 2469
17804c17808
< #line 2468
---
> #line 2471
17806c17810
< #line 2470
---
> #line 2473
17810c17814
< #line 2473 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2476 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
17817c17821
< #line 2477
---
> #line 2480
17819c17823
< #line 2479
---
> #line 2482
17821c17825
< #line 2481
---
> #line 2484
17823c17827
< #line 2482
---
> #line 2485
17825c17829
< #line 2483
---
> #line 2486
17827c17831
< #line 2484
---
> #line 2487
17833c17837
< #line 2486
---
> #line 2489
17838c17842
< #line 2489
---
> #line 2492
17840c17844
< #line 2490
---
> #line 2493
17844c17848
< #line 2501 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2504 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
17846c17850
< #line 2503 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2506 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
17848c17852
< #line 2492 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
---
> #line 2495 "/work/ldvuser/novikov/work/current--X--drivers/gpu/drm/i915/i915.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/21/dscv_tempdir/dscv/ri/68_1/drivers/gpu/drm/i915/i915_gem.c"
17856c17860
< #line 2495
---
> #line 2498
17858c17862
< #line 2497
---
> #line 2500
17860c17864
< #line 2498
---
> #line 2501
17862c17866
< #line 2499
---
> #line 2502
17864c17868
< #line 2500
---
> #line 2503
17866c17870
< #line 2501
---
> #line 2504
17868c17872
< #line 2501
---
> #line 2504
17870c17874
< #line 2501
---
> #line 2504
17872c17876
< #line 2501
---
> #line 2504
17874c17878
< #line 2501
---
> #line 2504
17877c17881
< #line 2501
---
> #line 2504
17879c17883
< #line 2501
---
> #line 2504
17881c17885
< #line 2501
---
> #line 2504
17883c17887
< #line 2501
---
> #line 2504
17886c17890
< #line 2501
---
> #line 2504
17889c17893
< #line 2501
---
> #line 2504
17891c17895
< #line 2501
---
> #line 2504
17894c17898
< #line 2503
---
> #line 2506
17896c17900
< #line 2503
---
> #line 2506
17898c17902
< #line 2503
---
> #line 2506
17900c17904
< #line 2503
---
> #line 2506
17903c17907
< #line 2503
---
> #line 2506
17905c17909
< #line 2503
---
> #line 2506
17907c17911
< #line 2503
---
> #line 2506
17909c17913
< #line 2503
---
> #line 2506
17912c17916
< #line 2503
---
> #line 2506
17915c17919
< #line 2505
---
> #line 2508
17917c17921
< #line 2507
---
> #line 2510
17919c17923
< #line 2508
---
> #line 2511

1967c1967
<   if (mtd->erasesize <= 4095U) {
---
>   erase.len = mtd->erasesize;
1969,1974d1968
<     erase.len = 4096U;
<   } else {
< #line 81
<     erase.len = mtd->erasesize;
<   }
< #line 82
1976c1970
< #line 84
---
> #line 81
1978c1972
< #line 84
---
> #line 81
1980c1974
< #line 85
---
> #line 82
1982c1976
< #line 87
---
> #line 84
1984c1978
< #line 88
---
> #line 85
1986c1980
< #line 89
---
> #line 86
1988c1982
< #line 89
---
> #line 86
1990c1984
< #line 90
---
> #line 87
1992c1986
< #line 91
---
> #line 88
1995c1989
< #line 94
---
> #line 91
2000c1994
< #line 97
---
> #line 94
2002c1996
< #line 98
---
> #line 95
2004c1998
< #line 100
---
> #line 97
2008c2002
< #line 103 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
> #line 100 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2017c2011
< #line 105
---
> #line 102
2019c2013
< #line 110
---
> #line 107
2021c2015
< #line 111
---
> #line 108
2023c2017
< #line 112
---
> #line 109
2028c2022
< #line 113
---
> #line 110
2030c2024
< #line 114
---
> #line 111
2032c2026
< #line 115
---
> #line 112
2037c2031
< #line 117
---
> #line 114
2039c2033
< #line 119
---
> #line 116
2041c2035
< #line 120
---
> #line 117
2044c2038
< #line 123
---
> #line 120
2046c2040
< #line 124
---
> #line 121
2051c2045
< #line 128
---
> #line 125
2053c2047
< #line 129
---
> #line 126
2055c2049
< #line 130
---
> #line 127
2060c2054
< #line 133
---
> #line 130
2062c2056
< #line 135
---
> #line 132
2064c2058
< #line 136
---
> #line 133
2068c2062
< #line 139 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
> #line 136 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2080c2074
< #line 142
---
> #line 139
2082c2076
< #line 142
---
> #line 139
2084c2078
< #line 143
---
> #line 140
2086c2080
< #line 144
---
> #line 141
2088c2082
< #line 147
---
> #line 144
2090c2084
< #line 148
---
> #line 145
2095c2089
< #line 150
---
> #line 147
2097c2091
< #line 151
---
> #line 148
2099c2093
< #line 152
---
> #line 149
2101c2095
< #line 153
---
> #line 150
2103c2097
< #line 154
---
> #line 151
2111c2105
< #line 157
---
> #line 154
2114c2108
< #line 158
---
> #line 155
2116c2110
< #line 159
---
> #line 156
2118c2112
< #line 160
---
> #line 157
2123c2117
< #line 161
---
> #line 158
2125c2119
< #line 162
---
> #line 159
2127c2121
< #line 163
---
> #line 160
2133c2127
< #line 166
---
> #line 163
2135c2129
< #line 168
---
> #line 165
2137c2131
< #line 169
---
> #line 166
2139c2133
< #line 170
---
> #line 167
2141c2135
< #line 171
---
> #line 168
2146c2140
< #line 172
---
> #line 169
2148c2142
< #line 173
---
> #line 170
2150c2144
< #line 174
---
> #line 171
2156c2150
< #line 157
---
> #line 154
2159c2153
< #line 158
---
> #line 155
2165c2159
< #line 178
---
> #line 175
2167c2161
< #line 178
---
> #line 175
2169c2163
< #line 178
---
> #line 175
2172c2166
< #line 179
---
> #line 176
2174c2168
< #line 178
---
> #line 175
2177c2171
< #line 178
---
> #line 175
2179c2173
< #line 179
---
> #line 176
2185c2179
< #line 181
---
> #line 178
2187c2181
< #line 182
---
> #line 179
2189c2183
< #line 183
---
> #line 180
2191c2185
< #line 184
---
> #line 181
2196c2190
< #line 187
---
> #line 184
2199c2193
< #line 188
---
> #line 185
2201c2195
< #line 189
---
> #line 186
2203c2197
< #line 190
---
> #line 187
2205c2199
< #line 191
---
> #line 188
2213c2207
< #line 194
---
> #line 191
2217c2211
< #line 197 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
> #line 194 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2227c2221
< #line 200
---
> #line 197
2229c2223
< #line 200
---
> #line 197
2231c2225
< #line 201
---
> #line 198
2233c2227
< #line 205
---
> #line 202
2235c2229
< #line 206
---
> #line 203
2240c2234
< #line 209
---
> #line 206
2242c2236
< #line 212
---
> #line 209
2244c2238
< #line 214
---
> #line 211
2246c2240
< #line 215
---
> #line 212
2252c2246
< #line 218
---
> #line 215
2254c2248
< #line 219
---
> #line 216
2258c2252
< #line 221 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
> #line 218 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2270c2264
< #line 223
---
> #line 220
2272c2266
< #line 224
---
> #line 221
2274c2268
< #line 225
---
> #line 222
2276c2270
< #line 228
---
> #line 225
2278c2272
< #line 228
---
> #line 225
2281c2275
< #line 229
---
> #line 226
2283c2277
< #line 230
---
> #line 227
2285c2279
< #line 231
---
> #line 228
2288c2282
< #line 233
---
> #line 230
2293c2287
< #line 236
---
> #line 233
2295c2289
< #line 237
---
> #line 234
2300c2294
< #line 238
---
> #line 235
2301a2296,2302
> #line 236
>     maxcount = count;
> #line 237
>     maxpos = page;
>   } else
> #line 238
>   if (count <= 1073741823U && maxcount > 3221225472U) {
2308c2309
<   if (count <= 1073741823U && maxcount > 3221225472U) {
---
>   if (count > maxcount && count <= 3221225471U) {
2315,2321d2315
<   if (count > maxcount && count <= 3221225471U) {
< #line 245
<     maxcount = count;
< #line 246
<     maxpos = page;
<   } else
< #line 247
2323c2317
< #line 249
---
> #line 246
2325c2319
< #line 250
---
> #line 247
2331c2325
< #line 228
---
> #line 225
2334c2328
< #line 228
---
> #line 225
2336c2330
< #line 229
---
> #line 226
2342c2336
< #line 253
---
> #line 250
2344c2338
< #line 254
---
> #line 251
2346c2340
< #line 255
---
> #line 252
2348c2342
< #line 256
---
> #line 253
2350c2344
< #line 257
---
> #line 254
2352c2346
< #line 259
---
> #line 256
2357c2351
< #line 262
---
> #line 259
2359c2353
< #line 263
---
> #line 260
2361c2355
< #line 265
---
> #line 262
2363c2357
< #line 266
---
> #line 263
2367c2361
< #line 269 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
> #line 266 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2373c2367
< #line 271
---
> #line 268
2375c2369
< #line 273
---
> #line 270
2377c2371
< #line 274
---
> #line 271
2382c2376
< #line 276
---
> #line 273
2384c2378
< #line 277
---
> #line 274
2386c2380
< #line 279
---
> #line 276
2390a2385,2388
> #line 279
>   if (mtd->erasesize <= 4095U) {
> #line 280
>     printk("<3>Eraseblock size of MTD partition %d too small\n", mtd->index);
2391a2390,2394
>     return;
>   } else {
> 
>   }
> #line 285
2393c2396
< #line 283
---
> #line 286
2395,2398d2397
< #line 285
<   find_next_position(cxt);
< #line 287
<   printk("<7>mtdoops: Attached to MTD device %d\n", mtd->index);
2399a2399,2402
>   find_next_position(cxt);
> #line 290
>   printk("<6>mtdoops: Attached to MTD device %d\n", mtd->index);
> #line 291
2403c2406
< #line 290 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
> #line 293 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2409c2412
< #line 292
---
> #line 295
2411c2414
< #line 294
---
> #line 297
2413c2416
< #line 295
---
> #line 298
2418c2421
< #line 297
---
> #line 300
2420c2423
< #line 298
---
> #line 301
2422c2425
< #line 299
---
> #line 302
2426c2429
< #line 301 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
> #line 304 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2434c2437
< #line 303
---
> #line 306
2436,2437d2438
< #line 304
<   mtd = cxt->mtd;
2438a2440,2441
>   mtd = cxt->mtd;
> #line 310
2440c2443
< #line 308
---
> #line 311
2445c2448
< #line 314
---
> #line 317
2447c2450
< #line 315
---
> #line 318
2449c2452
< #line 316
---
> #line 319
2451c2454
< #line 317
---
> #line 320
2456c2459
< #line 319
---
> #line 322
2458c2461
< #line 320
---
> #line 323
2460c2463
< #line 322
---
> #line 325
2462c2465
< #line 323
---
> #line 326
2466c2469
< #line 326 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
> #line 329 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2477c2480
< #line 328
---
> #line 331
2479,2480d2481
< #line 329
<   mtd = cxt->mtd;
2481a2483,2484
>   mtd = cxt->mtd;
> #line 335
2483c2486
< #line 333
---
> #line 336
2485c2488
< #line 334
---
> #line 337
2490c2493
< #line 337
---
> #line 340
2492c2495
< #line 338
---
> #line 341
2497,2498d2499
< #line 341
<   flags = _spin_lock_irqsave(& cxt->writecount_lock);
2499a2501,2502
>   flags = _spin_lock_irqsave(& cxt->writecount_lock);
> #line 347
2501c2504
< #line 345
---
> #line 348
2506c2509
< #line 347
---
> #line 350
2508c2511
< #line 348
---
> #line 351
2510c2513
< #line 349
---
> #line 352
2512c2515
< #line 350
---
> #line 353
2517c2520
< #line 353
---
> #line 356
2519c2522
< #line 354
---
> #line 357
2524c2527
< #line 356
---
> #line 359
2526c2529
< #line 356
---
> #line 359
2529c2532
< #line 357
---
> #line 360
2531c2534
< #line 359
---
> #line 362
2533c2536
< #line 361
---
> #line 364
2535c2538
< #line 362
---
> #line 365
2540c2543
< #line 363
---
> #line 366
2544c2547
< #line 365 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
> #line 368 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2550c2553
< #line 367
---
> #line 370
2552c2555
< #line 369
---
> #line 372
2554c2557
< #line 370
---
> #line 373
2559c2562
< #line 371
---
> #line 374
2561c2564
< #line 372
---
> #line 375
2566c2569
< #line 374
---
> #line 377
2568c2571
< #line 375
---
> #line 378
2572c2575
< #line 378 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
> #line 381 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2574c2577
< #line 383 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
> #line 386 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2576c2579
< #line 383
---
> #line 386
2578,2579c2581,2582
<     & mtdoops_console_setup, 0, 1, -1, 0, (void *)(& oops_cxt), 0};
< #line 393 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
>     & mtdoops_console_setup, 0, (short)0, -1, 0, (void *)(& oops_cxt), 0};
> #line 395 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2589,2590d2591
< #line 395
<   cxt = & oops_cxt;
2591a2593,2594
>   cxt = & oops_cxt;
> #line 399
2593,2594d2595
< #line 398
<   cxt->oops_buf = vmalloc(4096UL);
2596,2598c2597
<   if ((unsigned long )cxt->oops_buf == (unsigned long )((void *)0)) {
< #line 401
<     printk("<3>Failed to allocate oops buffer workspace\n");
---
>   cxt->oops_buf = vmalloc(4096UL);
2599a2599,2602
>   if ((unsigned long )cxt->oops_buf == (unsigned long )((void *)0)) {
> #line 403
>     printk("<3>Failed to allocate mtdoops buffer workspace\n");
> #line 404
2604c2607
< #line 405
---
> #line 407
2606c2609
< #line 405
---
> #line 407
2608c2611
< #line 405
---
> #line 407
2610c2613
< #line 405
---
> #line 407
2612c2615
< #line 405
---
> #line 407
2614c2617
< #line 406
---
> #line 408
2616c2619
< #line 406
---
> #line 408
2618c2621
< #line 406
---
> #line 408
2621c2624
< #line 406
---
> #line 408
2623,2624d2625
< #line 406
<   cxt->work_write.func = & mtdoops_workfunc_write;
2625a2627,2628
>   cxt->work_write.func = & mtdoops_workfunc_write;
> #line 410
2627c2630
< #line 409
---
> #line 411
2629c2632
< #line 410
---
> #line 412
2633c2636
< #line 413 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
> #line 415 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2639,2640d2641
< #line 415
<   cxt = & oops_cxt;
2641a2643,2644
>   cxt = & oops_cxt;
> #line 419
2643c2646
< #line 418
---
> #line 420
2645c2648
< #line 419
---
> #line 421
2647c2650
< #line 420
---
> #line 422
2651c2654
< #line 446
---
> #line 448
2653c2656
< #line 455
---
> #line 457
2655c2658
< #line 458
---
> #line 460
2657c2660
< #line 461
---
> #line 463
2659c2662
< #line 464 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
> #line 466 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2661c2664
< #line 467 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
---
> #line 469 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_7a--X--cpachecker/linux/csd_deg_dscv/10/dscv_tempdir/dscv/ri/32_7a/drivers/mtd/mtdoops.c.prepared"
2675c2678
< #line 533
---
> #line 535
2677c2680
< #line 513
---
> #line 515
2679c2682
< #line 522
---
> #line 524
2681c2684
< #line 530
---
> #line 532
2683c2686
< #line 531
---
> #line 533
2685c2688
< #line 531
---
> #line 533
2687c2690
< #line 532
---
> #line 534
2692c2695
< #line 539
---
> #line 541
2695c2698
< #line 543
---
> #line 545
2697c2700
< #line 543
---
> #line 545
2700c2703
< #line 548
---
> #line 550
2702c2705
< #line 555
---
> #line 557
2704c2707
< #line 556
---
> #line 558
2706c2709
< #line 557
---
> #line 559
2711c2714
< #line 563
---
> #line 565
2714c2717
< #line 574
---
> #line 576
2716c2719
< #line 575
---
> #line 577
2718c2721
< #line 582
---
> #line 584
2721c2724
< #line 593
---
> #line 595
2723c2726
< #line 594
---
> #line 596
2725c2728
< #line 601
---
> #line 603
2728c2731
< #line 612
---
> #line 614
2730c2733
< #line 613
---
> #line 615
2732c2735
< #line 620
---
> #line 622
2735c2738
< #line 631
---
> #line 633
2737c2740
< #line 632
---
> #line 634
2739c2742
< #line 639
---
> #line 641
2742c2745
< #line 640
---
> #line 642
2747c2750
< #line 539
---
> #line 541
2749,2750d2751
< #line 539
<   if (tmp___1 != 0 || ldv_s_mtdoops_notifier_mtd_notifier != 0) {
2751a2753,2754
>   if (tmp___1 != 0 || ldv_s_mtdoops_notifier_mtd_notifier != 0) {
> #line 543
2757c2760
< #line 654
---
> #line 656
2759c2762
< #line 655
---
> #line 657
2762c2765
< #line 658
---
> #line 660
2764c2767
< #line 661
---
> #line 663

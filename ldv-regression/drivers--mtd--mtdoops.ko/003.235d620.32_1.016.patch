2204c2204
< #line 43 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 47 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
2492a2493,2496
> #line 190 "include/linux/moduleparam.h"
> extern int param_set_ulong(char const   *val , struct kernel_param *kp ) ;
> #line 191
> extern int param_get_ulong(char *buffer , struct kernel_param *kp ) ;
2536a2541,2551
> #line 42 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
> static unsigned long record_size  =    4096;
> #line 43 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
> static char const   __param_str_record_size[12]  = 
> #line 43
>   {      'r',      'e',      'c',      'o', 
>         'r',      'd',      '_',      's', 
>         'i',      'z',      'e',      '\000'};
> #line 43 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
> static struct kernel_param  const  __param_record_size  __attribute__((__used__, __unused__,
> __section__("__param"), __aligned__(sizeof(void *))))  =    {__param_str_record_size, 256, 0, & param_set_ulong, & param_get_ulong, {& record_size}};
2537a2553,2585
> static char const   __mod_record_sizetype43[27]  __attribute__((__used__, __unused__,
> __section__(".modinfo")))  = 
> #line 43
>   {      'p',      'a',      'r',      'm', 
>         't',      'y',      'p',      'e', 
>         '=',      'r',      'e',      'c', 
>         'o',      'r',      'd',      '_', 
>         's',      'i',      'z',      'e', 
>         ':',      'u',      'l',      'o', 
>         'n',      'g',      '\000'};
> #line 44 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
> static char const   __mod_record_size45[72]  __attribute__((__used__, __unused__,
> __section__(".modinfo")))  = 
> #line 44
>   {      'p',      'a',      'r',      'm', 
>         '=',      'r',      'e',      'c', 
>         'o',      'r',      'd',      '_', 
>         's',      'i',      'z',      'e', 
>         ':',      'r',      'e',      'c', 
>         'o',      'r',      'd',      ' ', 
>         's',      'i',      'z',      'e', 
>         ' ',      'f',      'o',      'r', 
>         ' ',      'M',      'T',      'D', 
>         ' ',      'O',      'O',      'P', 
>         'S',      ' ',      'p',      'a', 
>         'g',      'e',      's',      ' ', 
>         'i',      'n',      ' ',      'b', 
>         'y',      't',      'e',      's', 
>         ' ',      '(',      'd',      'e', 
>         'f',      'a',      'u',      'l', 
>         't',      ' ',      '4',      '0', 
>         '9',      '6',      ')',      '\000'};
> #line 47 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
2539c2587
< #line 62 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 66 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
2545c2593
< #line 64
---
> #line 68
2547c2595
< #line 65
---
> #line 69
2551c2599
< #line 67 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 71 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
2557c2605
< #line 69
---
> #line 73
2559c2607
< #line 70
---
> #line 74
2563c2611
< #line 72 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 76 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
2569c2617
< #line 74
---
> #line 78
2571c2619
< #line 74
---
> #line 78
2575c2623
< #line 77 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 81 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
2581c2629
< #line 79
---
> #line 83
2583c2631
< #line 80
---
> #line 84
2585c2633
< #line 81
---
> #line 85
2589c2637
< #line 95 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 99 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
2591c2639
< #line 83 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 87 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
2611c2659
< #line 85
---
> #line 89
2613c2661
< #line 86
---
> #line 90
2615,2620d2662
< #line 86
<   start_page_offset = tmp * mtd->erasesize;
< #line 87
<   start_page = start_page_offset / (u32 )4096;
< #line 88
<   erase_pages = mtd->erasesize / (uint32_t )4096;
2621a2664,2669
>   start_page_offset = tmp * mtd->erasesize;
> #line 91
>   start_page = (unsigned long )start_page_offset / record_size;
> #line 92
>   erase_pages = (unsigned long )mtd->erasesize / record_size;
> #line 94
2623c2671
< #line 90
---
> #line 94
2625c2673
< #line 90
---
> #line 94
2627c2675
< #line 90
---
> #line 94
2629c2677
< #line 90
---
> #line 94
2631c2679
< #line 90
---
> #line 94
2633c2681
< #line 95
---
> #line 99
2635c2683
< #line 95
---
> #line 99
2637c2685
< #line 95
---
> #line 99
2640c2688
< #line 96
---
> #line 100
2642c2690
< #line 97
---
> #line 101
2644c2692
< #line 98
---
> #line 102
2646c2694
< #line 99
---
> #line 103
2648c2696
< #line 100
---
> #line 104
2650c2698
< #line 102
---
> #line 106
2652c2700
< #line 102
---
> #line 106
2654c2702
< #line 102
---
> #line 106
2656c2704
< #line 102
---
> #line 106
2659c2707
< #line 103
---
> #line 107
2661c2709
< #line 105
---
> #line 109
2663c2711
< #line 106
---
> #line 110
2665c2713
< #line 107
---
> #line 111
2667c2715
< #line 107
---
> #line 111
2669c2717
< #line 107
---
> #line 111
2671c2719
< #line 107
---
> #line 111
2674c2722
< #line 108
---
> #line 112
2676c2724
< #line 109
---
> #line 113
2679c2727
< #line 112
---
> #line 116
2684c2732
< #line 115
---
> #line 119
2686c2734
< #line 116
---
> #line 120
2688c2736
< #line 119
---
> #line 123
2690c2738
< #line 119
---
> #line 123
2692c2740
< #line 119
---
> #line 123
2696c2744
< #line 119
---
> #line 123
2699c2747
< #line 120
---
> #line 124
2701c2749
< #line 119
---
> #line 123
2704c2752
< #line 122
---
> #line 126
2708c2756
< #line 125 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 129 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
2714c2762
< #line 127
---
> #line 131
2716c2764
< #line 128
---
> #line 132
2718c2766
< #line 129
---
> #line 133
2723c2771
< #line 130
---
> #line 134
2725c2773
< #line 131
---
> #line 135
2727c2775
< #line 132
---
> #line 136
2732c2780
< #line 134
---
> #line 138
2734c2782
< #line 134
---
> #line 138
2736c2784
< #line 135
---
> #line 139
2738c2786
< #line 136
---
> #line 140
2743c2791
< #line 139
---
> #line 143
2745c2793
< #line 141
---
> #line 145
2747c2795
< #line 142
---
> #line 146
2751c2799
< #line 145 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 149 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
2763c2811
< #line 148
---
> #line 152
2765c2813
< #line 148
---
> #line 152
2767c2815
< #line 149
---
> #line 153
2769c2817
< #line 150
---
> #line 154
2771c2819
< #line 153
---
> #line 157
2773c2821
< #line 154
---
> #line 158
2778,2780c2826,2828
< #line 156
<   mod = (unsigned int )(cxt->nextpage * 4096) % mtd->erasesize;
< #line 157
---
> #line 160
>   mod = ((unsigned long )cxt->nextpage * record_size) % (unsigned long )mtd->erasesize;
> #line 161
2782,2784c2830,2832
< #line 158
<     cxt->nextpage = (uint32_t )cxt->nextpage + (mtd->erasesize - (uint32_t )mod) / (uint32_t )4096;
< #line 159
---
> #line 162
>     cxt->nextpage = (unsigned long )cxt->nextpage + (unsigned long )(mtd->erasesize - (uint32_t )mod) / record_size;
> #line 163
2786c2834
< #line 160
---
> #line 164
2794c2842
< #line 163
---
> #line 167
2796c2844
< #line 163
---
> #line 167
2800c2848
< #line 163
---
> #line 167
2803,2805c2851,2853
< #line 164
<     ret = (*(mtd->block_isbad))(mtd, cxt->nextpage * 4096);
< #line 165
---
> #line 168
>     ret = (*(mtd->block_isbad))(mtd, (unsigned long )cxt->nextpage * record_size);
> #line 169
2807c2855
< #line 166
---
> #line 170
2812c2860
< #line 167
---
> #line 171
2814c2862
< #line 168
---
> #line 172
2816c2864
< #line 169
---
> #line 173
2822,2827d2869
< #line 172
<     printk("<4>mtdoops: bad block at %08x\n", cxt->nextpage * 4096);
< #line 174
<     i = i + 1;
< #line 175
<     cxt->nextpage = (uint32_t )cxt->nextpage + mtd->erasesize / (uint32_t )4096;
2828a2871,2876
>     printk("<4>mtdoops: bad block at %08lx\n", (unsigned long )cxt->nextpage * record_size);
> #line 178
>     i = i + 1;
> #line 179
>     cxt->nextpage = (unsigned long )cxt->nextpage + (unsigned long )mtd->erasesize / record_size;
> #line 180
2830c2878
< #line 177
---
> #line 181
2835,2837c2883,2885
< #line 178
<     if ((uint32_t )i == (uint32_t )cxt->oops_pages / (mtd->erasesize / (uint32_t )4096)) {
< #line 179
---
> #line 182
>     if ((unsigned long )i == (unsigned long )cxt->oops_pages / ((unsigned long )mtd->erasesize / record_size)) {
> #line 183
2839c2887
< #line 180
---
> #line 184
2845c2893
< #line 184
---
> #line 188
2847c2895
< #line 184
---
> #line 188
2849c2897
< #line 184
---
> #line 188
2851c2899
< #line 184
---
> #line 188
2855c2903
< #line 184
---
> #line 188
2858,2860c2906,2908
< #line 185
<     ret = mtdoops_erase_block(cxt, cxt->nextpage * 4096);
< #line 184
---
> #line 189
>     ret = mtdoops_erase_block(cxt, (unsigned long )cxt->nextpage * record_size);
> #line 188
2863c2911
< #line 187
---
> #line 191
2865c2913
< #line 188
---
> #line 192
2867c2915
< #line 190
---
> #line 194
2869c2917
< #line 191
---
> #line 195
2874c2922
< #line 194
---
> #line 198
2876,2878c2924,2926
< #line 195
<     ret = (*(mtd->block_markbad))(mtd, cxt->nextpage * 4096);
< #line 196
---
> #line 199
>     ret = (*(mtd->block_markbad))(mtd, (unsigned long )cxt->nextpage * record_size);
> #line 200
2880c2928
< #line 197
---
> #line 201
2882c2930
< #line 198
---
> #line 202
2890c2938
< #line 201
---
> #line 205
2894c2942
< #line 204 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 208 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
2902,2903d2949
< #line 206
<   mtd = cxt->mtd;
2905,2907c2951,2955
<   if (cxt->writecount < 4096) {
< #line 211
<     memset(cxt->oops_buf + cxt->writecount, 255, 4096 - cxt->writecount);
---
>   mtd = cxt->mtd;
> #line 214
>   if ((unsigned long )cxt->writecount < record_size) {
> #line 215
>     memset(cxt->oops_buf + cxt->writecount, 255, record_size - (unsigned long )cxt->writecount);
2911c2959
< #line 214
---
> #line 218
2913,2914c2961,2963
< #line 215
<     ret = (*(mtd->panic_write))(mtd, cxt->nextpage * 4096, 4096, & retlen, cxt->oops_buf);
---
> #line 219
>     ret = (*(mtd->panic_write))(mtd, (unsigned long )cxt->nextpage * record_size,
>                                 record_size, & retlen, cxt->oops_buf);
2916,2917c2965,2967
< #line 218
<     ret = (*(mtd->write))(mtd, cxt->nextpage * 4096, 4096, & retlen, cxt->oops_buf);
---
> #line 222
>     ret = (*(mtd->write))(mtd, (unsigned long )cxt->nextpage * record_size, record_size,
>                           & retlen, cxt->oops_buf);
2919c2969
< #line 221
---
> #line 225
2921,2925c2971,2975
< #line 223
<   if (retlen != (size_t )4096 || ret < 0) {
< #line 224
<     printk("<3>mtdoops: write failure at %d (%td of %d written), error %d\n", cxt->nextpage * 4096,
<            retlen, 4096, ret);
---
> #line 227
>   if (retlen != record_size || ret < 0) {
> #line 228
>     printk("<3>mtdoops: write failure at %ld (%td of %ld written), error %d\n", (unsigned long )cxt->nextpage * record_size,
>            retlen, record_size, ret);
2929c2979
< #line 226
---
> #line 230
2931c2981
< #line 228
---
> #line 232
2933c2983
< #line 229
---
> #line 233
2937c2987
< #line 232 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 236 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
2944c2994
< #line 235
---
> #line 239
2946c2996
< #line 235
---
> #line 239
2948c2998
< #line 237
---
> #line 241
2950c3000
< #line 238
---
> #line 242
2954c3004
< #line 240 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 244 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
2966c3016
< #line 242
---
> #line 246
2968c3018
< #line 243
---
> #line 247
2970c3020
< #line 244
---
> #line 248
2972c3022
< #line 247
---
> #line 251
2974c3024
< #line 247
---
> #line 251
2976c3026
< #line 247
---
> #line 251
2980c3030
< #line 247
---
> #line 251
2983c3033
< #line 249
---
> #line 253
2985,2987c3035,3037
< #line 250
<     ret = (*(mtd->read))(mtd, page * 4096, 8, & retlen, (u_char *)(& count[0]));
< #line 251
---
> #line 254
>     ret = (*(mtd->read))(mtd, (unsigned long )page * record_size, 8, & retlen, (u_char *)(& count[0]));
> #line 255
2989,2990c3039,3040
< #line 252
<       printk("<3>mtdoops: read failure at %d (%td of 8 read), err %d\n", page * 4096,
---
> #line 256
>       printk("<3>mtdoops: read failure at %ld (%td of 8 read), err %d\n", (unsigned long )page * record_size,
2992c3042
< #line 254
---
> #line 258
2997c3047
< #line 257
---
> #line 261
2999c3049
< #line 258
---
> #line 262
3004c3054
< #line 259
---
> #line 263
3006c3056
< #line 260
---
> #line 264
3011c3061
< #line 261
---
> #line 265
3013c3063
< #line 262
---
> #line 266
3018c3068
< #line 263
---
> #line 267
3020c3070
< #line 264
---
> #line 268
3022c3072
< #line 265
---
> #line 269
3025c3075
< #line 266
---
> #line 270
3027c3077
< #line 267
---
> #line 271
3029c3079
< #line 268
---
> #line 272
3032c3082
< #line 269
---
> #line 273
3034c3084
< #line 270
---
> #line 274
3036c3086
< #line 271
---
> #line 275
3039c3089
< #line 272
---
> #line 276
3041c3091
< #line 274
---
> #line 278
3043c3093
< #line 275
---
> #line 279
3049c3099
< #line 247
---
> #line 251
3052c3102
< #line 278
---
> #line 282
3054c3104
< #line 279
---
> #line 283
3056c3106
< #line 280
---
> #line 284
3058c3108
< #line 281
---
> #line 285
3060c3110
< #line 282
---
> #line 286
3065c3115
< #line 285
---
> #line 289
3067c3117
< #line 286
---
> #line 290
3069c3119
< #line 288
---
> #line 292
3071c3121
< #line 289
---
> #line 293
3075c3125
< #line 292 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 296 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
3086c3136
< #line 294
---
> #line 298
3088c3138
< #line 295
---
> #line 299
3090,3092c3140,3142
< #line 297
<   __base = 4096;
< #line 297
---
> #line 301
>   __base = record_size;
> #line 301
3094c3144
< #line 297
---
> #line 301
3096c3146
< #line 299
---
> #line 303
3098c3148
< #line 299
---
> #line 303
3100c3150
< #line 299
---
> #line 303
3104c3154
< #line 300
---
> #line 304
3110c3160
< #line 302
---
> #line 306
3112c3162
< #line 303
---
> #line 307
3117c3167
< #line 305
---
> #line 309
3119c3169
< #line 306
---
> #line 310
3121c3171
< #line 308
---
> #line 312
3126,3128c3176,3178
< #line 311
<   if (mtd->erasesize < (uint32_t )4096) {
< #line 312
---
> #line 315
>   if ((unsigned long )mtd->erasesize < record_size) {
> #line 316
3130c3180
< #line 314
---
> #line 318
3135c3185
< #line 317
---
> #line 321
3137c3187
< #line 318
---
> #line 322
3139c3189
< #line 320
---
> #line 324
3144c3194
< #line 324
---
> #line 328
3146c3196
< #line 324
---
> #line 328
3148c3198
< #line 326
---
> #line 330
3150c3200
< #line 327
---
> #line 331
3152c3202
< #line 328
---
> #line 332
3157c3207
< #line 331
---
> #line 335
3159,3161c3209,3211
< #line 332
<   cxt->oops_pages = (int )mtd->size / 4096;
< #line 333
---
> #line 336
>   cxt->oops_pages = (unsigned long )((int )mtd->size) / record_size;
> #line 337
3163c3213
< #line 334
---
> #line 338
3165c3215
< #line 335
---
> #line 339
3169c3219
< #line 337 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 341 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
3175c3225
< #line 339
---
> #line 343
3177c3227
< #line 341
---
> #line 345
3179c3229
< #line 342
---
> #line 346
3184c3234
< #line 344
---
> #line 348
3186c3236
< #line 345
---
> #line 349
3188c3238
< #line 346
---
> #line 350
3192c3242
< #line 348 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 352 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
3201c3251
< #line 350
---
> #line 354
3203c3253
< #line 351
---
> #line 355
3205c3255
< #line 354
---
> #line 358
3207c3257
< #line 355
---
> #line 359
3212c3262
< #line 361
---
> #line 365
3214c3264
< #line 361
---
> #line 365
3216c3266
< #line 361
---
> #line 365
3219c3269
< #line 362
---
> #line 366
3221c3271
< #line 363
---
> #line 367
3223c3273
< #line 363
---
> #line 367
3225c3275
< #line 363
---
> #line 367
3228c3278
< #line 364
---
> #line 368
3233c3283
< #line 366
---
> #line 370
3235c3285
< #line 367
---
> #line 371
3237c3287
< #line 367
---
> #line 371
3239c3289
< #line 367
---
> #line 371
3242c3292
< #line 369
---
> #line 373
3244c3294
< #line 369
---
> #line 373
3246c3296
< #line 369
---
> #line 373
3248c3298
< #line 371
---
> #line 375
3251c3301
< #line 373
---
> #line 377
3255c3305
< #line 373
---
> #line 377
3258c3308
< #line 374
---
> #line 378
3262c3312
< #line 376 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 380 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
3274c3324
< #line 379
---
> #line 383
3276c3326
< #line 380
---
> #line 384
3278c3328
< #line 383
---
> #line 387
3280c3330
< #line 384
---
> #line 388
3282c3332
< #line 385
---
> #line 389
3287c3337
< #line 388
---
> #line 392
3289c3339
< #line 389
---
> #line 393
3294c3344
< #line 392
---
> #line 396
3296c3346
< #line 392
---
> #line 396
3298c3348
< #line 392
---
> #line 396
3301c3351
< #line 395
---
> #line 399
3303c3353
< #line 396
---
> #line 400
3305c3355
< #line 396
---
> #line 400
3307c3357
< #line 396
---
> #line 400
3310c3360
< #line 397
---
> #line 401
3315c3365
< #line 400
---
> #line 404
3317c3367
< #line 401
---
> #line 405
3319c3369
< #line 402
---
> #line 406
3321c3371
< #line 402
---
> #line 406
3323c3373
< #line 402
---
> #line 406
3325c3375
< #line 403
---
> #line 407
3327c3377
< #line 404
---
> #line 408
3332,3335c3382,3385
< #line 407
<   if (count + (unsigned int )cxt->writecount > 4096U) {
< #line 408
<     count = 4096 - cxt->writecount;
---
> #line 411
>   if ((unsigned long )(count + (unsigned int )cxt->writecount) > record_size) {
> #line 412
>     count = record_size - (unsigned long )cxt->writecount;
3339c3389
< #line 410
---
> #line 414
3341c3391
< #line 410
---
> #line 414
3343c3393
< #line 411
---
> #line 415
3345c3395
< #line 413
---
> #line 417
3347c3397
< #line 413
---
> #line 417
3349c3399
< #line 413
---
> #line 417
3352,3354c3402,3404
< #line 415
<   if (cxt->writecount == 4096) {
< #line 416
---
> #line 419
>   if ((unsigned long )cxt->writecount == record_size) {
> #line 420
3359c3409
< #line 417
---
> #line 421
3363c3413
< #line 419
---
> #line 423
3366c3416
< #line 419 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 423 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
3372c3422
< #line 421
---
> #line 425
3374c3424
< #line 423
---
> #line 427
3376c3426
< #line 424
---
> #line 428
3381c3431
< #line 425
---
> #line 429
3383c3433
< #line 426
---
> #line 430
3385c3435
< #line 427
---
> #line 431
3390c3440
< #line 429
---
> #line 433
3392c3442
< #line 430
---
> #line 434
3397c3447
< #line 432
---
> #line 436
3399c3449
< #line 433
---
> #line 437
3403c3453
< #line 436 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 440 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
3405c3455
< #line 441 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 445 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
3407c3457
< #line 441
---
> #line 445
3410c3460
< #line 461 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 473 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
3412c3462
< #line 450
---
> #line 454
3414c3464
< #line 450 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 454 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
3422c3472
< #line 452
---
> #line 456
3424c3474,3492
< #line 454
---
> #line 458
>   if ((record_size & 4095UL) != 0UL) {
> #line 459
>     printk("<3>mtdoops: record_size must be a multiple of 4096\n");
> #line 460
>     return (-22);
>   } else {
> 
>   }
> #line 462
>   if (record_size < 4096UL) {
> #line 463
>     printk("<3>mtdoops: record_size must be over 4096 bytes\n");
> #line 464
>     return (-22);
>   } else {
> 
>   }
> #line 466
3426,3428c3494,3496
< #line 455
<   cxt->oops_buf = vmalloc(4096);
< #line 456
---
> #line 467
>   cxt->oops_buf = vmalloc(record_size);
> #line 468
3430c3498
< #line 457
---
> #line 469
3432c3500
< #line 458
---
> #line 470
3437c3505
< #line 461
---
> #line 473
3439c3507
< #line 461
---
> #line 473
3441c3509
< #line 461
---
> #line 473
3444c3512
< #line 462
---
> #line 474
3446c3514
< #line 462
---
> #line 474
3448c3516
< #line 462
---
> #line 474
3450c3518
< #line 462
---
> #line 474
3452c3520
< #line 462
---
> #line 474
3454c3522
< #line 462
---
> #line 474
3456c3524
< #line 462
---
> #line 474
3459c3527
< #line 462
---
> #line 474
3462c3530
< #line 463
---
> #line 475
3464c3532
< #line 463
---
> #line 475
3466c3534
< #line 463
---
> #line 475
3468c3536
< #line 463
---
> #line 475
3470c3538
< #line 463
---
> #line 475
3472c3540
< #line 463
---
> #line 475
3474c3542
< #line 463
---
> #line 475
3477c3545
< #line 463
---
> #line 475
3480c3548
< #line 465
---
> #line 477
3482c3550
< #line 466
---
> #line 478
3484c3552
< #line 467
---
> #line 479
3488c3556
< #line 470
---
> #line 482
3490c3558
< #line 470 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 482 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
3496c3564
< #line 472
---
> #line 484
3498c3566
< #line 474
---
> #line 486
3500c3568
< #line 475
---
> #line 487
3502c3570
< #line 476
---
> #line 488
3504c3572
< #line 477
---
> #line 489
3506c3574
< #line 478
---
> #line 490
3508c3576
< #line 479
---
> #line 491
3512c3580
< #line 482 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 494 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
3518c3586
< #line 482
---
> #line 494
3520c3588
< #line 482
---
> #line 494
3524c3592
< #line 483 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 495 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
3530c3598
< #line 483
---
> #line 495
3532c3600
< #line 483
---
> #line 495
3536,3538c3604,3606
< #line 485 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
< static char const   __mod_license485[12]  __attribute__((__used__, __unused__, __section__(".modinfo")))  = 
< #line 485
---
> #line 497 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
> static char const   __mod_license497[12]  __attribute__((__used__, __unused__, __section__(".modinfo")))  = 
> #line 497
3542,3544c3610,3612
< #line 486 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
< static char const   __mod_author486[47]  __attribute__((__used__, __unused__, __section__(".modinfo")))  = 
< #line 486
---
> #line 498 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
> static char const   __mod_author498[47]  __attribute__((__used__, __unused__, __section__(".modinfo")))  = 
> #line 498
3557,3558c3625,3626
< #line 487 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
< static char const   __mod_description487[49]  __attribute__((__used__, __unused__,
---
> #line 499 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
> static char const   __mod_description499[49]  __attribute__((__used__, __unused__,
3560c3628
< #line 487
---
> #line 499
3574c3642
< #line 505
---
> #line 517
3576c3644
< #line 514
---
> #line 526
3578c3646
< #line 517
---
> #line 529
3580c3648
< #line 520
---
> #line 532
3582c3650
< #line 523 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 535 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
3584c3652
< #line 526 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
---
> #line 538 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--32_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/32_1/drivers/mtd/mtdoops.c"
3598c3666
< #line 582
---
> #line 589
3600c3668
< #line 591
---
> #line 598
3602c3670
< #line 601
---
> #line 607
3604c3672
< #line 602
---
> #line 608
3606c3674
< #line 602
---
> #line 608
3608c3676
< #line 603
---
> #line 609
3613,3614d3680
< #line 604
<   ldv_s_mtdoops_notifier_mtd_notifier = 0;
3615a3682,3683
>   ldv_s_mtdoops_notifier_mtd_notifier = 0;
> #line 616
3617c3685
< #line 610
---
> #line 616
3619c3687
< #line 610
---
> #line 616
3623c3691
< #line 610
---
> #line 616
3626c3694
< #line 614
---
> #line 620
3628c3696
< #line 614
---
> #line 620
3631c3699
< #line 619
---
> #line 625
3633c3701
< #line 628
---
> #line 633
3635c3703
< #line 629
---
> #line 634
3637c3705
< #line 630
---
> #line 635
3642c3710
< #line 636
---
> #line 641
3645c3713
< #line 649
---
> #line 653
3647c3715
< #line 650
---
> #line 654
3649c3717
< #line 657
---
> #line 661
3652c3720
< #line 670
---
> #line 673
3654c3722
< #line 671
---
> #line 674
3656c3724
< #line 678
---
> #line 681
3659c3727
< #line 691
---
> #line 693
3661c3729
< #line 692
---
> #line 694
3663c3731
< #line 699
---
> #line 701
3666,3667d3733
< #line 712
<     ldv_handler_precall();
3668a3735,3736
>     ldv_handler_precall();
> #line 714
3670c3738
< #line 720
---
> #line 721
3673c3741
< #line 721
---
> #line 722

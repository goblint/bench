2279c2279
< #line 43 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 47 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
3824a3825,3828
> #line 190 "include/linux/moduleparam.h"
> extern int param_set_ulong(char const   *val , struct kernel_param *kp ) ;
> #line 191
> extern int param_get_ulong(char *buffer , struct kernel_param *kp ) ;
3868a3873,3883
> #line 42 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
> static unsigned long record_size  =    4096;
> #line 43 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
> static char const   __param_str_record_size[12]  = 
> #line 43
>   {      'r',      'e',      'c',      'o', 
>         'r',      'd',      '_',      's', 
>         'i',      'z',      'e',      '\000'};
> #line 43 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
> static struct kernel_param  const  __param_record_size  __attribute__((__used__, __unused__,
> __section__("__param"), __aligned__(sizeof(void *))))  =    {__param_str_record_size, 256, 0, & param_set_ulong, & param_get_ulong, {& record_size}};
3869a3885,3917
> static char const   __mod_record_sizetype43[27]  __attribute__((__used__, __unused__,
> __section__(".modinfo")))  = 
> #line 43
>   {      'p',      'a',      'r',      'm', 
>         't',      'y',      'p',      'e', 
>         '=',      'r',      'e',      'c', 
>         'o',      'r',      'd',      '_', 
>         's',      'i',      'z',      'e', 
>         ':',      'u',      'l',      'o', 
>         'n',      'g',      '\000'};
> #line 44 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
> static char const   __mod_record_size45[72]  __attribute__((__used__, __unused__,
> __section__(".modinfo")))  = 
> #line 44
>   {      'p',      'a',      'r',      'm', 
>         '=',      'r',      'e',      'c', 
>         'o',      'r',      'd',      '_', 
>         's',      'i',      'z',      'e', 
>         ':',      'r',      'e',      'c', 
>         'o',      'r',      'd',      ' ', 
>         's',      'i',      'z',      'e', 
>         ' ',      'f',      'o',      'r', 
>         ' ',      'M',      'T',      'D', 
>         ' ',      'O',      'O',      'P', 
>         'S',      ' ',      'p',      'a', 
>         'g',      'e',      's',      ' ', 
>         'i',      'n',      ' ',      'b', 
>         'y',      't',      'e',      's', 
>         ' ',      '(',      'd',      'e', 
>         'f',      'a',      'u',      'l', 
>         't',      ' ',      '4',      '0', 
>         '9',      '6',      ')',      '\000'};
> #line 47 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
3871c3919
< #line 62 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 66 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
3877c3925
< #line 64
---
> #line 68
3879c3927
< #line 65
---
> #line 69
3883c3931
< #line 67 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 71 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
3889c3937
< #line 69
---
> #line 73
3891c3939
< #line 70
---
> #line 74
3895c3943
< #line 72 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 76 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
3901c3949
< #line 74
---
> #line 78
3903c3951
< #line 74
---
> #line 78
3907c3955
< #line 77 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 81 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
3913c3961
< #line 79
---
> #line 83
3915c3963
< #line 80
---
> #line 84
3917c3965
< #line 81
---
> #line 85
3921c3969
< #line 95 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 99 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
3923c3971
< #line 83 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 87 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
3943c3991
< #line 85
---
> #line 89
3945c3993
< #line 86
---
> #line 90
3947,3952d3994
< #line 86
<   start_page_offset = tmp * mtd->erasesize;
< #line 87
<   start_page = start_page_offset / (u32 )4096;
< #line 88
<   erase_pages = mtd->erasesize / (uint32_t )4096;
3953a3996,4001
>   start_page_offset = tmp * mtd->erasesize;
> #line 91
>   start_page = (unsigned long )start_page_offset / record_size;
> #line 92
>   erase_pages = (unsigned long )mtd->erasesize / record_size;
> #line 94
3955c4003
< #line 90
---
> #line 94
3957c4005
< #line 90
---
> #line 94
3959c4007
< #line 90
---
> #line 94
3961c4009
< #line 90
---
> #line 94
3963c4011
< #line 90
---
> #line 94
3965c4013
< #line 95
---
> #line 99
3967c4015
< #line 95
---
> #line 99
3969c4017
< #line 95
---
> #line 99
3972c4020
< #line 96
---
> #line 100
3974c4022
< #line 97
---
> #line 101
3976c4024
< #line 98
---
> #line 102
3978c4026
< #line 99
---
> #line 103
3980c4028
< #line 100
---
> #line 104
3982c4030
< #line 102
---
> #line 106
3984c4032
< #line 102
---
> #line 106
3986c4034
< #line 102
---
> #line 106
3988c4036
< #line 102
---
> #line 106
3991c4039
< #line 103
---
> #line 107
3993c4041
< #line 105
---
> #line 109
3995c4043
< #line 106
---
> #line 110
3997c4045
< #line 107
---
> #line 111
3999c4047
< #line 107
---
> #line 111
4001c4049
< #line 107
---
> #line 111
4003c4051
< #line 107
---
> #line 111
4006c4054
< #line 108
---
> #line 112
4008c4056
< #line 109
---
> #line 113
4011c4059
< #line 112
---
> #line 116
4016c4064
< #line 115
---
> #line 119
4018c4066
< #line 116
---
> #line 120
4020c4068
< #line 119
---
> #line 123
4022c4070
< #line 119
---
> #line 123
4024c4072
< #line 119
---
> #line 123
4028c4076
< #line 119
---
> #line 123
4031c4079
< #line 120
---
> #line 124
4033c4081
< #line 119
---
> #line 123
4036c4084
< #line 122
---
> #line 126
4040c4088
< #line 125 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 129 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4046c4094
< #line 127
---
> #line 131
4048c4096
< #line 128
---
> #line 132
4050c4098
< #line 129
---
> #line 133
4055c4103
< #line 130
---
> #line 134
4057c4105
< #line 131
---
> #line 135
4059c4107
< #line 132
---
> #line 136
4064c4112
< #line 134
---
> #line 138
4066c4114
< #line 134
---
> #line 138
4068c4116
< #line 135
---
> #line 139
4070c4118
< #line 136
---
> #line 140
4075c4123
< #line 139
---
> #line 143
4077c4125
< #line 141
---
> #line 145
4079c4127
< #line 142
---
> #line 146
4083c4131
< #line 145 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 149 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4095c4143
< #line 148
---
> #line 152
4097c4145
< #line 148
---
> #line 152
4099c4147
< #line 149
---
> #line 153
4101c4149
< #line 150
---
> #line 154
4103c4151
< #line 153
---
> #line 157
4105c4153
< #line 154
---
> #line 158
4110,4112c4158,4160
< #line 156
<   mod = (unsigned int )(cxt->nextpage * 4096) % mtd->erasesize;
< #line 157
---
> #line 160
>   mod = ((unsigned long )cxt->nextpage * record_size) % (unsigned long )mtd->erasesize;
> #line 161
4114,4116c4162,4164
< #line 158
<     cxt->nextpage = (uint32_t )cxt->nextpage + (mtd->erasesize - (uint32_t )mod) / (uint32_t )4096;
< #line 159
---
> #line 162
>     cxt->nextpage = (unsigned long )cxt->nextpage + (unsigned long )(mtd->erasesize - (uint32_t )mod) / record_size;
> #line 163
4118c4166
< #line 160
---
> #line 164
4126c4174
< #line 163
---
> #line 167
4128c4176
< #line 163
---
> #line 167
4132c4180
< #line 163
---
> #line 167
4135,4137c4183,4185
< #line 164
<     ret = (*(mtd->block_isbad))(mtd, cxt->nextpage * 4096);
< #line 165
---
> #line 168
>     ret = (*(mtd->block_isbad))(mtd, (unsigned long )cxt->nextpage * record_size);
> #line 169
4139c4187
< #line 166
---
> #line 170
4144c4192
< #line 167
---
> #line 171
4146c4194
< #line 168
---
> #line 172
4148c4196
< #line 169
---
> #line 173
4154,4159d4201
< #line 172
<     printk("<4>mtdoops: bad block at %08x\n", cxt->nextpage * 4096);
< #line 174
<     i = i + 1;
< #line 175
<     cxt->nextpage = (uint32_t )cxt->nextpage + mtd->erasesize / (uint32_t )4096;
4160a4203,4208
>     printk("<4>mtdoops: bad block at %08lx\n", (unsigned long )cxt->nextpage * record_size);
> #line 178
>     i = i + 1;
> #line 179
>     cxt->nextpage = (unsigned long )cxt->nextpage + (unsigned long )mtd->erasesize / record_size;
> #line 180
4162c4210
< #line 177
---
> #line 181
4167,4169c4215,4217
< #line 178
<     if ((uint32_t )i == (uint32_t )cxt->oops_pages / (mtd->erasesize / (uint32_t )4096)) {
< #line 179
---
> #line 182
>     if ((unsigned long )i == (unsigned long )cxt->oops_pages / ((unsigned long )mtd->erasesize / record_size)) {
> #line 183
4171c4219
< #line 180
---
> #line 184
4177c4225
< #line 184
---
> #line 188
4179c4227
< #line 184
---
> #line 188
4181c4229
< #line 184
---
> #line 188
4183c4231
< #line 184
---
> #line 188
4187c4235
< #line 184
---
> #line 188
4190,4192c4238,4240
< #line 185
<     ret = mtdoops_erase_block(cxt, cxt->nextpage * 4096);
< #line 184
---
> #line 189
>     ret = mtdoops_erase_block(cxt, (unsigned long )cxt->nextpage * record_size);
> #line 188
4195c4243
< #line 187
---
> #line 191
4197c4245
< #line 188
---
> #line 192
4199c4247
< #line 190
---
> #line 194
4201c4249
< #line 191
---
> #line 195
4206c4254
< #line 194
---
> #line 198
4208,4210c4256,4258
< #line 195
<     ret = (*(mtd->block_markbad))(mtd, cxt->nextpage * 4096);
< #line 196
---
> #line 199
>     ret = (*(mtd->block_markbad))(mtd, (unsigned long )cxt->nextpage * record_size);
> #line 200
4212c4260
< #line 197
---
> #line 201
4214c4262
< #line 198
---
> #line 202
4222c4270
< #line 201
---
> #line 205
4226c4274
< #line 204 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 208 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4234,4235d4281
< #line 206
<   mtd = cxt->mtd;
4237,4239c4283,4287
<   if (cxt->writecount < 4096) {
< #line 211
<     memset(cxt->oops_buf + cxt->writecount, 255, 4096 - cxt->writecount);
---
>   mtd = cxt->mtd;
> #line 214
>   if ((unsigned long )cxt->writecount < record_size) {
> #line 215
>     memset(cxt->oops_buf + cxt->writecount, 255, record_size - (unsigned long )cxt->writecount);
4243c4291
< #line 214
---
> #line 218
4245,4246c4293,4295
< #line 215
<     ret = (*(mtd->panic_write))(mtd, cxt->nextpage * 4096, 4096, & retlen, cxt->oops_buf);
---
> #line 219
>     ret = (*(mtd->panic_write))(mtd, (unsigned long )cxt->nextpage * record_size,
>                                 record_size, & retlen, cxt->oops_buf);
4248,4249c4297,4299
< #line 218
<     ret = (*(mtd->write))(mtd, cxt->nextpage * 4096, 4096, & retlen, cxt->oops_buf);
---
> #line 222
>     ret = (*(mtd->write))(mtd, (unsigned long )cxt->nextpage * record_size, record_size,
>                           & retlen, cxt->oops_buf);
4251c4301
< #line 221
---
> #line 225
4253,4257c4303,4307
< #line 223
<   if (retlen != (size_t )4096 || ret < 0) {
< #line 224
<     printk("<3>mtdoops: write failure at %d (%td of %d written), error %d\n", cxt->nextpage * 4096,
<            retlen, 4096, ret);
---
> #line 227
>   if (retlen != record_size || ret < 0) {
> #line 228
>     printk("<3>mtdoops: write failure at %ld (%td of %ld written), error %d\n", (unsigned long )cxt->nextpage * record_size,
>            retlen, record_size, ret);
4261c4311
< #line 226
---
> #line 230
4263c4313
< #line 228
---
> #line 232
4265c4315
< #line 229
---
> #line 233
4269c4319
< #line 232 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 236 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4276c4326
< #line 235
---
> #line 239
4278c4328
< #line 235
---
> #line 239
4280c4330
< #line 237
---
> #line 241
4282c4332
< #line 238
---
> #line 242
4286c4336
< #line 240 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 244 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4298c4348
< #line 242
---
> #line 246
4300c4350
< #line 243
---
> #line 247
4302c4352
< #line 244
---
> #line 248
4304c4354
< #line 247
---
> #line 251
4306c4356
< #line 247
---
> #line 251
4308c4358
< #line 247
---
> #line 251
4312c4362
< #line 247
---
> #line 251
4315c4365
< #line 249
---
> #line 253
4317,4319c4367,4369
< #line 250
<     ret = (*(mtd->read))(mtd, page * 4096, 8, & retlen, (u_char *)(& count[0]));
< #line 251
---
> #line 254
>     ret = (*(mtd->read))(mtd, (unsigned long )page * record_size, 8, & retlen, (u_char *)(& count[0]));
> #line 255
4321,4322c4371,4372
< #line 252
<       printk("<3>mtdoops: read failure at %d (%td of 8 read), err %d\n", page * 4096,
---
> #line 256
>       printk("<3>mtdoops: read failure at %ld (%td of 8 read), err %d\n", (unsigned long )page * record_size,
4324c4374
< #line 254
---
> #line 258
4329c4379
< #line 257
---
> #line 261
4331c4381
< #line 258
---
> #line 262
4336c4386
< #line 259
---
> #line 263
4338c4388
< #line 260
---
> #line 264
4343c4393
< #line 261
---
> #line 265
4345c4395
< #line 262
---
> #line 266
4350c4400
< #line 263
---
> #line 267
4352c4402
< #line 264
---
> #line 268
4354c4404
< #line 265
---
> #line 269
4357c4407
< #line 266
---
> #line 270
4359c4409
< #line 267
---
> #line 271
4361c4411
< #line 268
---
> #line 272
4364c4414
< #line 269
---
> #line 273
4366c4416
< #line 270
---
> #line 274
4368c4418
< #line 271
---
> #line 275
4371c4421
< #line 272
---
> #line 276
4373c4423
< #line 274
---
> #line 278
4375c4425
< #line 275
---
> #line 279
4381c4431
< #line 247
---
> #line 251
4384c4434
< #line 278
---
> #line 282
4386c4436
< #line 279
---
> #line 283
4388c4438
< #line 280
---
> #line 284
4390c4440
< #line 281
---
> #line 285
4392c4442
< #line 282
---
> #line 286
4397c4447
< #line 285
---
> #line 289
4399c4449
< #line 286
---
> #line 290
4401c4451
< #line 288
---
> #line 292
4403c4453
< #line 289
---
> #line 293
4407c4457
< #line 292 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 296 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4418c4468
< #line 294
---
> #line 298
4420c4470
< #line 295
---
> #line 299
4422,4424c4472,4474
< #line 297
<   __base = 4096;
< #line 297
---
> #line 301
>   __base = record_size;
> #line 301
4426c4476
< #line 297
---
> #line 301
4428c4478
< #line 299
---
> #line 303
4430c4480
< #line 299
---
> #line 303
4432c4482
< #line 299
---
> #line 303
4436c4486
< #line 300
---
> #line 304
4442c4492
< #line 302
---
> #line 306
4444c4494
< #line 303
---
> #line 307
4449c4499
< #line 305
---
> #line 309
4451c4501
< #line 306
---
> #line 310
4453c4503
< #line 308
---
> #line 312
4458,4460c4508,4510
< #line 311
<   if (mtd->erasesize < (uint32_t )4096) {
< #line 312
---
> #line 315
>   if ((unsigned long )mtd->erasesize < record_size) {
> #line 316
4462c4512
< #line 314
---
> #line 318
4467c4517
< #line 317
---
> #line 321
4469c4519
< #line 318
---
> #line 322
4471c4521
< #line 320
---
> #line 324
4476c4526
< #line 324
---
> #line 328
4478c4528
< #line 324
---
> #line 328
4480c4530
< #line 326
---
> #line 330
4482c4532
< #line 327
---
> #line 331
4484c4534
< #line 328
---
> #line 332
4489c4539
< #line 331
---
> #line 335
4491,4493c4541,4543
< #line 332
<   cxt->oops_pages = (int )mtd->size / 4096;
< #line 333
---
> #line 336
>   cxt->oops_pages = (unsigned long )((int )mtd->size) / record_size;
> #line 337
4495c4545
< #line 334
---
> #line 338
4497c4547
< #line 335
---
> #line 339
4501c4551
< #line 337 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 341 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4507c4557
< #line 339
---
> #line 343
4509c4559
< #line 341
---
> #line 345
4511c4561
< #line 342
---
> #line 346
4516c4566
< #line 344
---
> #line 348
4518c4568
< #line 345
---
> #line 349
4520c4570
< #line 346
---
> #line 350
4524c4574
< #line 348 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 352 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4533c4583
< #line 350
---
> #line 354
4535c4585
< #line 351
---
> #line 355
4537c4587
< #line 354
---
> #line 358
4539c4589
< #line 355
---
> #line 359
4544c4594
< #line 361
---
> #line 365
4546c4596
< #line 361
---
> #line 365
4548c4598
< #line 361
---
> #line 365
4551c4601
< #line 362
---
> #line 366
4553c4603
< #line 363
---
> #line 367
4555c4605
< #line 363
---
> #line 367
4557c4607
< #line 363
---
> #line 367
4560c4610
< #line 364
---
> #line 368
4565c4615
< #line 366
---
> #line 370
4567c4617
< #line 367
---
> #line 371
4569c4619
< #line 367
---
> #line 371
4571c4621
< #line 367
---
> #line 371
4574c4624
< #line 369
---
> #line 373
4576c4626
< #line 369
---
> #line 373
4578c4628
< #line 369
---
> #line 373
4580c4630
< #line 371
---
> #line 375
4583c4633
< #line 373
---
> #line 377
4587c4637
< #line 373
---
> #line 377
4590c4640
< #line 374
---
> #line 378
4594c4644
< #line 376 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 380 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4606c4656
< #line 379
---
> #line 383
4608c4658
< #line 380
---
> #line 384
4610c4660
< #line 383
---
> #line 387
4612c4662
< #line 384
---
> #line 388
4614c4664
< #line 385
---
> #line 389
4619c4669
< #line 388
---
> #line 392
4621c4671
< #line 389
---
> #line 393
4626c4676
< #line 392
---
> #line 396
4628c4678
< #line 392
---
> #line 396
4630c4680
< #line 392
---
> #line 396
4633c4683
< #line 395
---
> #line 399
4635c4685
< #line 396
---
> #line 400
4637c4687
< #line 396
---
> #line 400
4639c4689
< #line 396
---
> #line 400
4642c4692
< #line 397
---
> #line 401
4647c4697
< #line 400
---
> #line 404
4649c4699
< #line 401
---
> #line 405
4651c4701
< #line 402
---
> #line 406
4653c4703
< #line 402
---
> #line 406
4655c4705
< #line 402
---
> #line 406
4657c4707
< #line 403
---
> #line 407
4659c4709
< #line 404
---
> #line 408
4664,4667c4714,4717
< #line 407
<   if (count + (unsigned int )cxt->writecount > 4096U) {
< #line 408
<     count = 4096 - cxt->writecount;
---
> #line 411
>   if ((unsigned long )(count + (unsigned int )cxt->writecount) > record_size) {
> #line 412
>     count = record_size - (unsigned long )cxt->writecount;
4671c4721
< #line 410
---
> #line 414
4673c4723
< #line 410
---
> #line 414
4675c4725
< #line 411
---
> #line 415
4677c4727
< #line 413
---
> #line 417
4679c4729
< #line 413
---
> #line 417
4681c4731
< #line 413
---
> #line 417
4684,4686c4734,4736
< #line 415
<   if (cxt->writecount == 4096) {
< #line 416
---
> #line 419
>   if ((unsigned long )cxt->writecount == record_size) {
> #line 420
4691c4741
< #line 417
---
> #line 421
4695c4745
< #line 419
---
> #line 423
4698c4748
< #line 419 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 423 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4704c4754
< #line 421
---
> #line 425
4706c4756
< #line 423
---
> #line 427
4708c4758
< #line 424
---
> #line 428
4713c4763
< #line 425
---
> #line 429
4715c4765
< #line 426
---
> #line 430
4717c4767
< #line 427
---
> #line 431
4722c4772
< #line 429
---
> #line 433
4724c4774
< #line 430
---
> #line 434
4729c4779
< #line 432
---
> #line 436
4731c4781
< #line 433
---
> #line 437
4735c4785
< #line 436 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 440 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4737c4787
< #line 441 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 445 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4739c4789
< #line 441
---
> #line 445
4742c4792
< #line 461 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 473 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4744c4794
< #line 462 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 474 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4746c4796
< #line 463 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 475 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4748c4798
< #line 450
---
> #line 454
4750c4800
< #line 450 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 454 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4758c4808
< #line 452
---
> #line 456
4760c4810,4828
< #line 454
---
> #line 458
>   if ((record_size & 4095UL) != 0UL) {
> #line 459
>     printk("<3>mtdoops: record_size must be a multiple of 4096\n");
> #line 460
>     return (-22);
>   } else {
> 
>   }
> #line 462
>   if (record_size < 4096UL) {
> #line 463
>     printk("<3>mtdoops: record_size must be over 4096 bytes\n");
> #line 464
>     return (-22);
>   } else {
> 
>   }
> #line 466
4762,4764c4830,4832
< #line 455
<   cxt->oops_buf = vmalloc(4096);
< #line 456
---
> #line 467
>   cxt->oops_buf = vmalloc(record_size);
> #line 468
4766c4834
< #line 457
---
> #line 469
4768c4836
< #line 458
---
> #line 470
4773c4841
< #line 461
---
> #line 473
4775c4843
< #line 461
---
> #line 473
4777c4845
< #line 461
---
> #line 473
4780c4848
< #line 462
---
> #line 474
4782c4850
< #line 462
---
> #line 474
4784c4852
< #line 462
---
> #line 474
4786c4854
< #line 462
---
> #line 474
4789c4857
< #line 462
---
> #line 474
4791c4859
< #line 462
---
> #line 474
4793c4861
< #line 462
---
> #line 474
4795c4863
< #line 462
---
> #line 474
4798c4866
< #line 462
---
> #line 474
4801c4869
< #line 463
---
> #line 475
4803c4871
< #line 463
---
> #line 475
4805c4873
< #line 463
---
> #line 475
4807c4875
< #line 463
---
> #line 475
4810c4878
< #line 463
---
> #line 475
4812c4880
< #line 463
---
> #line 475
4814c4882
< #line 463
---
> #line 475
4816c4884
< #line 463
---
> #line 475
4819c4887
< #line 463
---
> #line 475
4822c4890
< #line 465
---
> #line 477
4824c4892
< #line 466
---
> #line 478
4826c4894
< #line 467
---
> #line 479
4830c4898
< #line 470
---
> #line 482
4832c4900
< #line 470 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 482 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4838c4906
< #line 472
---
> #line 484
4840c4908
< #line 474
---
> #line 486
4842c4910
< #line 475
---
> #line 487
4844c4912
< #line 476
---
> #line 488
4846c4914
< #line 477
---
> #line 489
4848c4916
< #line 478
---
> #line 490
4850c4918
< #line 479
---
> #line 491
4854c4922
< #line 482 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 494 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4860c4928
< #line 482
---
> #line 494
4862c4930
< #line 482
---
> #line 494
4866c4934
< #line 483 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 495 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4872c4940
< #line 483
---
> #line 495
4874c4942
< #line 483
---
> #line 495
4878,4880c4946,4948
< #line 485 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
< static char const   __mod_license485[12]  __attribute__((__used__, __unused__, __section__(".modinfo")))  = 
< #line 485
---
> #line 497 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
> static char const   __mod_license497[12]  __attribute__((__used__, __unused__, __section__(".modinfo")))  = 
> #line 497
4884,4886c4952,4954
< #line 486 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
< static char const   __mod_author486[47]  __attribute__((__used__, __unused__, __section__(".modinfo")))  = 
< #line 486
---
> #line 498 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
> static char const   __mod_author498[47]  __attribute__((__used__, __unused__, __section__(".modinfo")))  = 
> #line 498
4899,4900c4967,4968
< #line 487 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
< static char const   __mod_description487[49]  __attribute__((__used__, __unused__,
---
> #line 499 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
> static char const   __mod_description499[49]  __attribute__((__used__, __unused__,
4902c4970
< #line 487
---
> #line 499
4916c4984
< #line 505
---
> #line 517
4918c4986
< #line 514
---
> #line 526
4920c4988
< #line 517
---
> #line 529
4922c4990
< #line 520
---
> #line 532
4924c4992
< #line 523 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 535 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4926c4994
< #line 526 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
---
> #line 538 "/work/ldvuser/novikov/work/current--X--drivers/mtd/mtdoops.ko--X--defaultlinux--X--68_1--X--cpachecker/linux/csd_deg_dscv/11/dscv_tempdir/dscv/ri/68_1/drivers/mtd/mtdoops.c"
4940c5008
< #line 582
---
> #line 589
4942c5010
< #line 591
---
> #line 598
4944c5012
< #line 601
---
> #line 607
4946c5014
< #line 602
---
> #line 608
4948c5016
< #line 602
---
> #line 608
4950c5018
< #line 603
---
> #line 609
4955,4956d5022
< #line 604
<   ldv_s_mtdoops_notifier_mtd_notifier = 0;
4957a5024,5025
>   ldv_s_mtdoops_notifier_mtd_notifier = 0;
> #line 616
4959c5027
< #line 610
---
> #line 616
4961c5029
< #line 610
---
> #line 616
4965c5033
< #line 610
---
> #line 616
4968c5036
< #line 614
---
> #line 620
4970c5038
< #line 614
---
> #line 620
4973c5041
< #line 619
---
> #line 625
4975c5043
< #line 628
---
> #line 633
4977c5045
< #line 629
---
> #line 634
4979c5047
< #line 630
---
> #line 635
4984c5052
< #line 636
---
> #line 641
4987c5055
< #line 649
---
> #line 653
4989c5057
< #line 650
---
> #line 654
4991c5059
< #line 657
---
> #line 661
4994c5062
< #line 670
---
> #line 673
4996c5064
< #line 671
---
> #line 674
4998c5066
< #line 678
---
> #line 681
5001c5069
< #line 691
---
> #line 693
5003c5071
< #line 692
---
> #line 694
5005c5073
< #line 699
---
> #line 701
5008,5009d5075
< #line 712
<     ldv_handler_precall();
5010a5077,5078
>     ldv_handler_precall();
> #line 714
5012c5080
< #line 720
---
> #line 721
5015c5083
< #line 721
---
> #line 722
